!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("microsoftTeams",[],t):"object"==typeof exports?exports.microsoftTeams=t():e.microsoftTeams=t()}("undefined"!=typeof self?self:this,(()=>(()=>{var e={302:(e,t,n)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(o=r))})),t.splice(o,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(65)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},65:(e,t,n)=>{e.exports=function(e){function t(e){let n,o,i,a=null;function s(...e){if(!s.enabled)return;const r=s,o=Number(new Date),i=o-(n||o);r.diff=i,r.prev=n,r.curr=o,n=o,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,o)=>{if("%%"===n)return"%";a++;const i=t.formatters[o];if("function"==typeof i){const t=e[a];n=i.call(r,t),e.splice(a,1),a--}return n})),t.formatArgs.call(r,e);(r.log||t.log).apply(r,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=r,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(o!==t.namespaces&&(o=t.namespaces,i=t.enabled(e)),i),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function r(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(o),...t.skips.map(o).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(247),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},247:e=>{var t=1e3,n=60*t,r=60*n,o=24*r;function i(e){if(!((e=String(e)).length>100)){var i=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(i){var a=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return 6048e5*a;case"days":case"day":case"d":return a*o;case"hours":case"hour":case"hrs":case"hr":case"h":return a*r;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}function a(e){var i=Math.abs(e);return i>=o?Math.round(e/o)+"d":i>=r?Math.round(e/r)+"h":i>=n?Math.round(e/n)+"m":i>=t?Math.round(e/t)+"s":e+"ms"}function s(e){var i=Math.abs(e);return i>=o?c(e,i,o,"day"):i>=r?c(e,i,r,"hour"):i>=n?c(e,i,n,"minute"):i>=t?c(e,i,t,"second"):e+" ms"}function c(e,t,n,r){var o=t>=1.5*n;return Math.round(e/n)+" "+r+(o?"s":"")}e.exports=function(e,t){t=t||{};var n=typeof e;if("string"===n&&e.length>0)return i(e);if("number"===n&&isFinite(e))return t.long?s(e):a(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}(()=>{n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}})(),(()=>{n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})();var r={};return(()=>{"use strict";n.r(r),n.d(r,{ActionObjectType:()=>_,ChannelType:()=>V,ChildAppWindow:()=>fr,DialogDimension:()=>U,ErrorCode:()=>k,FileOpenPreference:()=>F,FrameContexts:()=>D,HostClientType:()=>M,HostName:()=>H,LiveShareHost:()=>Uo,NotificationTypes:()=>mn,ParentAppWindow:()=>pr,SecondaryM365ContentIdName:()=>A,TaskModuleDimension:()=>x,TeamType:()=>L,UserSettingTypes:()=>vn,UserTeamRole:()=>N,ViewerActionTypes:()=>hn,app:()=>tt,appEntity:()=>si,appInitialization:()=>oo,appInstallDialog:()=>Mn,authentication:()=>Oe,barCode:()=>tr,calendar:()=>br,call:()=>ro,chat:()=>nr,clipboard:()=>or,conversations:()=>wn,dialog:()=>Ge,enablePrintCapability:()=>co,executeDeepLink:()=>To,files:()=>ti,geoLocation:()=>cr,getAdaptiveCardSchemaVersion:()=>lr,getContext:()=>lo,getMruTabInstances:()=>Po,getTabInstances:()=>So,initialize:()=>so,initializeWithFrameContext:()=>Fo,liveShare:()=>Do,location:()=>gr,logs:()=>gn,mail:()=>Sr,marketplace:()=>ei,media:()=>Vn,meeting:()=>hr,meetingRoom:()=>ni,menus:()=>je,monetization:()=>vr,navigateBack:()=>Mo,navigateCrossDomain:()=>Oo,navigateToTab:()=>Ro,notifications:()=>ri,openFilePreview:()=>On,pages:()=>st,people:()=>Ir,print:()=>uo,profile:()=>Tr,registerAppButtonClickHandler:()=>go,registerAppButtonHoverEnterHandler:()=>mo,registerAppButtonHoverLeaveHandler:()=>ho,registerBackButtonHandler:()=>vo,registerBeforeUnloadHandler:()=>Co,registerChangeSettingsHandler:()=>yo,registerCustomHandler:()=>kn,registerFocusEnterHandler:()=>bo,registerFullScreenHandler:()=>po,registerOnLoadHandler:()=>wo,registerOnThemeChangeHandler:()=>fo,registerUserSettingsChangeHandler:()=>Rn,remoteCamera:()=>oi,returnFocus:()=>ko,search:()=>zr,secondaryBrowser:()=>dr,sendCustomEvent:()=>An,sendCustomMessage:()=>_n,setFrameContext:()=>Eo,settings:()=>_o,shareDeepLink:()=>Io,sharing:()=>Gr,stageView:()=>jr,tasks:()=>Ho,teams:()=>ci,teamsCore:()=>Pr,uploadCustomApp:()=>Fn,version:()=>Me,videoEffects:()=>Wr,videoEffectsEx:()=>li,visualMedia:()=>Yr,webStorage:()=>eo});var e,t,o=(0,n(302).debug)("teamsJs");function i(e){return o.extend(e)}function a(e,t){return"".concat(e,"_").concat(t)}function s(e){return/^v\d+_[\w.]+$/.test(e)}!function(e){e.V_0="v0",e.V_1="v1",e.V_2="v2",e.V_3="v3"}(e||(e={})),function(e){e.App_GetContext="app.getContext",e.App_Initialize="app.initialize",e.App_NotifyAppLoaded="app.notifyAppLoaded",e.App_NotifyExpectedFailure="app.notifyExpectedFailure",e.App_NotifyFailure="app.notifyFailure",e.App_NotifySuccess="app.notifySuccess",e.App_OpenLink="app.openLink",e.App_RegisterOnThemeChangeHandler="app.registerOnThemeChangeHandler",e.AppEntity_SelectAppEntity="appEntity.selectAppEntity",e.BarCode_HasPermission="barCode.hasPermission",e.BarCode_RequestPermission="barCode.requestPermission",e.BarCode_ScanBarCode="barCode.scanBarCode",e.Calendar_ComposeMeeting="calendar.composeMeeting",e.Calendar_OpenCalendarItem="calendar.openCalendarItem",e.Call_StartCall="call.startCall",e.Clipboard_Read="clipboard.read",e.Clipboard_Write="clipboard.write",e.Dialog_AdaptiveCard_Bot_Open="dialog.adaptiveCard.bot.open",e.Dialog_AdaptiveCard_Open="dialog.adaptiveCard.open",e.Dialog_Update_Resize="dialog.update.resize",e.Dialog_Url_Bot_Open="dialog.url.bot.open",e.Dialog_Url_Open="dialog.url.open",e.Dialog_Url_Submit="dialog.url.submit",e.Dialog_Url_SendMessageToParentFromDialog="dialog.url.sendMessageToParentFromDialog",e.Dialog_Url_SendMessageToDialog="dialog.url.sendMessageToDialog",e.GeoLocation_GetCurrentLocation="geoLocation.getCurrentLocation",e.GeoLocation_HasPermission="geoLocation.hasPermission",e.GeoLocation_Map_ChooseLocation="geoLocation.map.chooseLocation",e.GeoLocation_RequestPermission="geoLocation.hasPermission",e.GeoLocation_ShowLocation="geoLocation.showLocation",e.Location_GetLocation="location.getLocation",e.Location_ShowLocation="location.showLocation",e.Mail_ComposeMail="mail.composeMail",e.Mail_OpenMailItem="mail.openMailItem",e.Marketplace_AddOrUpdateCartItems="marketplace.addOrUpdateCartItems",e.Marketplace_GetCart="marketplace.getCart",e.Marketplace_RemoveCardItems="marketplace.removeCartItems",e.Marketplace_UpdateCartStatus="marketplace.updateCartStatus",e.Media_CaptureImage="media.captureImage",e.Media_Controller="media.controller",e.Media_GetMedia="media.getMedia",e.Media_HasPermission="media.hasPermission",e.Media_RequestPermission="media.requestPermission",e.Media_ScanBarCode="media.scanBarCode",e.Media_SelectMedia="media.selectMedia",e.Media_ViewImages="media.viewImages",e.Navigation_NavigateBack="navigation.navigateBack",e.Navigation_NavigateCrossDomain="navigation.navigateCrossDomain",e.Navigation_NavigateToTab="navigation.navigateToTab",e.Navigation_ReturnFocus="navigation.returnFocus",e.Pages_AppButton_OnClick="pages.appButton.onClick",e.Pages_AppButton_OnHoverEnter="pages.appButton.onHoverEnter",e.Pages_AppButton_OnHoverLeave="pages.appButton.onHoverLeave",e.Pages_BackStack_NavigateBack="pages.backStack.navigateBack",e.Pages_BackStack_RegisterBackButtonHandler="pages.backStack.registerBackButtonHandler",e.Pages_Config_RegisterChangeConfigHandler="pages.config.registerChangeConfigHandler",e.Pages_Config_RegisterOnRemoveHandlerHelper="pages.config.registerOnRemoveHandlerHelper",e.Pages_Config_RegisterOnSaveHandlerHelper="pages.config.registerOnSaveHandlerHelper",e.Pages_Config_SetConfig="pages.config.setConfig",e.Pages_Config_SetValidityState="pages.config.setValidityState",e.Pages_CurrentApp_NavigateTo="pages.currentApp.navigateTo",e.Pages_CurrentApp_NavigateToDefaultPage="pages.currentApp.navigateToDefaultPage",e.Pages_FullTrust_EnterFullscreen="pages.fullTrust.enterFullscreen",e.Pages_FullTrust_ExitFullscreen="pages.fullTrust.exitFullscreen",e.Pages_GetConfig="pages.getConfig.",e.Pages_NavigateCrossDomain="pages.navigateCrossDomain",e.Pages_NavigateToApp="pages.navigateToApp",e.Pages_RegisterFocusEnterHandler="pages.registerFocusEnterHandler",e.Pages_RegisterFullScreenHandler="pages.registerFullScreenHandler",e.Pages_ReturnFocus="pages.returnFocus",e.Pages_SetCurrentFrame="pages.setCurrentFrame",e.Pages_ShareDeepLink="pages.shareDeepLink",e.Pages_Tabs_GetMruTabInstances="pages.tabs.getMruTabInstances",e.Pages_Tabs_GetTabInstances="pages.tabs.getTabInstances",e.Pages_Tabs_NavigateToTab="pages.tabs.navigateToTab",e.PublicAPIs_ExecuteDeepLink="executeDeepLink",e.PublicAPIs_GetContext="getContext",e.PublicAPIs_GetMruTabInstances="getMruTabInstances",e.PublicAPIs_GetTabInstances="getTabInstances",e.PublicAPIs_Initialize="initialize",e.PublicAPIs_RegisterAppButtonClickHandler="registerAppButtonClickHandler",e.PublicAPIs_RegisterAppButtonHoverEnterHandler="registerAppButtonHoverEnterHandler",e.PublicAPIs_RegisterAppButtonHoverLeaveHandler="registerAppButtonHoverLeaveHandler",e.PublicAPIs_RegisterBackButtonHandler="registerBackButtonHandler",e.PublicAPIs_RegisterChangeSettingsHandler="registerChangeSettingsHandler",e.PublicAPIs_RegisterFocusEnterHandler="registerFocusEnterHandler",e.PublicAPIs_RegisterFullScreenHandler="registerFullScreenHandler",e.PublicAPIs_RegisterOnLoadHandler="registerOnLoadHandler",e.PublicAPIs_RegisterOnThemeChangeHandlerHelper="registerOnThemeChangeHandlerHelper",e.PublicAPIs_SetFrameContext="setFrameContext",e.PublicAPIs_ShareDeepLink="shareDeepLink",e.RegisterHandler="registerHandler",e.RegisterOnThemeChangeHandler="registerOnThemeChangeHandler",e.Settings_Remove_Failure="settings.remove.failure",e.Settings_Remove_Success="settings.remove.success",e.Settings_Save_Failure="settings.save.failure",e.Settings_Save_Success="settings.save.success",e.Tasks_StartTask="tasks.startTask",e.Tasks_SubmitTask="tasks.submitTask",e.Tasks_UpdateTask="tasks.updateTask"}(t||(t={}));var c="2.0.1",u="2.0.3",l="1.9.0",d="1.8.0",f=["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","teams.live.com","devspaces.skype.com","ssauth.skype.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","outlook.office.com","outlook-sdf.office.com","outlook.office365.com","outlook-sdf.office365.com","outlook.live.com","outlook-sdf.live.com","*.teams.microsoft.com","*.www.office.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.microsoft365.com","www.microsoft365.com","bing.com","edgeservices.bing.com","www.bing.com","www.staging-bing-int.com","teams.cloud.microsoft","outlook.cloud.microsoft","m365.cloud.microsoft","copilot.microsoft.com"],p=/^https:\/\//,g="https",m="teams.microsoft.com",h="The library has not yet been initialized",v="The runtime has not yet been initialized",w="The runtime version is not supported",C=function(){function e(){}return e.initializeCalled=!1,e.initializeCompleted=!1,e.additionalValidOrigins=[],e.initializePromise=void 0,e.isFramelessWindow=!1,e.frameContext=void 0,e.hostClientType=void 0,e.printCapabilityEnabled=!1,e}();const b={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let y;const S=new Uint8Array(16);function P(){if(!y&&(y="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!y))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return y(S)}const I=[];for(let e=0;e<256;++e)I.push((e+256).toString(16).slice(1));function T(e,t=0){return(I[e[t+0]]+I[e[t+1]]+I[e[t+2]]+I[e[t+3]]+"-"+I[e[t+4]]+I[e[t+5]]+"-"+I[e[t+6]]+I[e[t+7]]+"-"+I[e[t+8]]+I[e[t+9]]+"-"+I[e[t+10]]+I[e[t+11]]+I[e[t+12]]+I[e[t+13]]+I[e[t+14]]+I[e[t+15]]).toLowerCase()}const E=function(e,t,n){if(b.randomUUID&&!t&&!e)return b.randomUUID();const r=(e=e||{}).random||(e.rng||P)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return T(r)};var F,_,A,k,R,O,M,H,D,L,N,U;!function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(F||(F={})),function(e){e.M365Content="m365content"}(_||(_={})),function(e){e.DriveId="driveId",e.GroupId="groupId",e.SiteId="siteId",e.UserId="userId"}(A||(A={})),function(e){e[e.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",e[e.INTERNAL_ERROR=500]="INTERNAL_ERROR",e[e.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",e[e.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",e[e.NETWORK_ERROR=2e3]="NETWORK_ERROR",e[e.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",e[e.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",e[e.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",e[e.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",e[e.THROTTLE=7e3]="THROTTLE",e[e.USER_ABORT=8e3]="USER_ABORT",e[e.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",e[e.OLD_PLATFORM=9e3]="OLD_PLATFORM",e[e.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",e[e.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(k||(k={})),function(e){e.GeoLocation="geolocation",e.Media="media"}(R||(R={})),function(e){e.TextPlain="text/plain",e.TextHtml="text/html",e.ImagePNG="image/png",e.ImageJPEG="image/jpeg"}(O||(O={})),function(e){e.desktop="desktop",e.web="web",e.android="android",e.ios="ios",e.ipados="ipados",e.macos="macos",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows",e.teamsRoomsAndroid="teamsRoomsAndroid",e.teamsPhones="teamsPhones",e.teamsDisplays="teamsDisplays"}(M||(M={})),function(e){e.office="Office",e.outlook="Outlook",e.outlookWin32="OutlookWin32",e.orange="Orange",e.places="Places",e.teams="Teams",e.teamsModern="TeamsModern"}(H||(H={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.stage="stage",e.meetingStage="meetingStage"}(D||(D={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(L||(L={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(N||(N={})),function(e){e.Large="large",e.Medium="medium",e.Small="small"}(U||(U={}));var V,x=U;!function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(V||(V={}));var B={errorCode:k.NOT_SUPPORTED_ON_PLATFORM},W=1,z=5,G={adaptiveCardSchemaVersion:{majorVersion:1,minorVersion:5}},j=new Error("Invalid input count: Must supply a valid image count (limit of 10)."),q=new Error("Invalid response: Received more images than the specified max limit in the response.");function J(e,t){if("*."===e.substring(0,2)){var n=e.substring(1);if(t.length>n.length&&t.split(".").length===n.split(".").length&&t.substring(t.length-n.length)===n)return!0}else if(e===t)return!0;return!1}var K=i("validateOrigin");function Z(e){if(!ae(e))return K("Origin %s is invalid because it is not using https protocol. Protocol being used: %s",e,e.protocol),!1;var t=e.host;if(f.some((function(e){return J(e,t)})))return!0;for(var n=0,r=C.additionalValidOrigins;n<r.length;n++){var o=r[n];if(J("https://"===o.substring(0,8)?o.substring(8):o,t))return!0}return K("Origin %s is invalid because it is not an origin approved by this library or included in the call to app.initialize.\nOrigins approved by this library: %o\nOrigins included in app.initialize: %o",e,f,C.additionalValidOrigins),!1}function X(e){return function(t,n){if(!t)throw new Error(e||n)}}function $(e,t){if("string"!=typeof e||"string"!=typeof t)return NaN;var n=e.split("."),r=t.split(".");function o(e){return/^\d+$/.test(e)}if(!n.every(o)||!r.every(o))return NaN;for(;n.length<r.length;)n.push("0");for(;r.length<n.length;)r.push("0");for(var i=0;i<n.length;++i)if(Number(n[i])!=Number(r[i]))return Number(n[i])>Number(r[i])?1:-1;return 0}function Q(){return E()}function Y(e){return Object.keys(e).forEach((function(t){"object"==typeof e[t]&&Y(e[t])})),Object.freeze(e)}function ee(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var o=e.apply(void 0,n);return o.then((function(e){t&&t(void 0,e)})).catch((function(e){t&&t(e)})),o}function te(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var o=e.apply(void 0,n);return o.then((function(){t&&t(null)})).catch((function(e){t&&t(e)})),o}function ne(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var o=e.apply(void 0,n);return o.then((function(e){t&&t(null,e)})).catch((function(e){t&&t(e,null)})),o}function re(e,t,n){return new Promise((function(r,o){var i=setTimeout(o,t,n);e().then((function(e){clearTimeout(i),r(e)})).catch((function(e){clearTimeout(i),o(e)}))}))}function oe(e){var t=new URL("https://teams.microsoft.com/l/entity/"+encodeURIComponent(e.appId)+"/"+encodeURIComponent(e.pageId));return e.webUrl&&t.searchParams.append("webUrl",e.webUrl),(e.channelId||e.subPageId)&&t.searchParams.append("context",JSON.stringify({channelId:e.channelId,subEntityId:e.subPageId})),t.toString()}function ie(e){return!($("".concat(e.majorVersion,".").concat(e.minorVersion),"".concat(W,".").concat(z))>=0)}function ae(e){return"https:"===e.protocol}function se(e,t){return new Promise((function(n,r){e||r("MimeType cannot be null or empty."),t||r("Base64 string cannot be null or empty.");var o=atob(t);if(e.startsWith("image/")){for(var i=new Uint8Array(o.length),a=0;a<o.length;a++)i[a]=o.charCodeAt(a);n(new Blob([i],{type:e}))}n(new Blob([o],{type:e}))}))}function ce(e){return new Promise((function(t,n){0===e.size&&n(new Error("Blob cannot be empty."));var r=new FileReader;r.onloadend=function(){r.result?t(r.result.toString().split(",")[1]):n(new Error("Failed to read the blob"))},r.onerror=function(){n(r.error)},r.readAsDataURL(e)}))}function ue(){if(le())throw new Error("window object undefined at SSR check");return window}function le(){return"undefined"==typeof window}var de=function(){return de=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},de.apply(this,arguments)},fe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},pe=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},ge=i("runtime"),me=3;function he(e){return e.apiVersion===me}var ve={apiVersion:-1,supports:{}};function we(e){if(he(e))return!0;throw-1===e.apiVersion?new Error(v):new Error(w)}var Ce=ve,be={apiVersion:3,hostVersionsInfo:G,isLegacyTeams:!0,supports:{app:{lifecycle:{}},appInstallDialog:{},appEntity:{},call:{},chat:{},conversations:{},dialog:{card:{bot:{}},url:{bot:{}},update:{}},interactive:{},logs:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{config:{},backStack:{},fullTrust:{}},remoteCamera:{},teams:{fullTrust:{}},teamsCore:{},video:{sharedFrame:{}}}},ye=[M.desktop,M.web,M.rigel,M.surfaceHub,M.teamsRoomsWindows,M.teamsRoomsAndroid,M.teamsPhones,M.teamsDisplays],Se=[M.android,M.ios,M.ipados],Pe=pe(pe([],ye,!0),Se,!0);function Ie(e){var t=e;if(t.apiVersion<me&&Te.forEach((function(e){t.apiVersion===e.versionToUpgradeFrom&&(t=e.upgradeToNextVersion(t))})),he(t))return t;throw new Error("Received a runtime that could not be upgraded to the latest version")}var Te=[{versionToUpgradeFrom:1,upgradeToNextVersion:function(e){var t;return{apiVersion:2,hostVersionsInfo:void 0,isLegacyTeams:e.isLegacyTeams,supports:de(de({},e.supports),{dialog:e.supports.dialog?{card:void 0,url:e.supports.dialog,update:null===(t=e.supports.dialog)||void 0===t?void 0:t.update}:void 0})}}},{versionToUpgradeFrom:2,upgradeToNextVersion:function(e){var t=e.supports,n=(t.appNotification,fe(t,["appNotification"]));return de(de({},e),{apiVersion:3,supports:n})}}],Ee={"1.0.0":[{capability:{pages:{appButton:{},tabs:{}},stageView:{}},hostClientTypes:ye}],"1.9.0":[{capability:{location:{}},hostClientTypes:Pe}],"2.0.0":[{capability:{people:{}},hostClientTypes:Pe},{capability:{sharing:{}},hostClientTypes:[M.desktop,M.web]}],"2.0.1":[{capability:{teams:{fullTrust:{joinedTeams:{}}}},hostClientTypes:[M.android,M.desktop,M.ios,M.teamsRoomsAndroid,M.teamsPhones,M.teamsDisplays,M.web]},{capability:{webStorage:{}},hostClientTypes:[M.desktop]}],"2.0.5":[{capability:{webStorage:{}},hostClientTypes:[M.android,M.desktop,M.ios]}]},Fe=ge.extend("generateBackCompatRuntimeConfig");function _e(e,t){var n=de({},e);for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&("object"!=typeof t[r]||Array.isArray(t[r])?r in e||(n[r]=t[r]):n[r]=_e(e[r]||{},t[r]));return n}function Ae(e,t,n){Fe("generating back compat runtime config for %s",e);var r=de({},t.supports);Fe("Supported capabilities in config before updating based on highestSupportedVersion: %o",r),Object.keys(n).forEach((function(t){$(e,t)>=0&&n[t].forEach((function(e){void 0!==C.hostClientType&&e.hostClientTypes.includes(C.hostClientType)&&(r=_e(r,e.capability))}))}));var o={apiVersion:me,hostVersionsInfo:G,isLegacyTeams:!0,supports:r};return Fe("Runtime config after updating based on highestSupportedVersion: %o",o),o}var ke=ge.extend("applyRuntimeConfig");function Re(e){"string"==typeof e.apiVersion&&(ke("Trying to apply runtime with string apiVersion, processing as v1: %o",e),e=de(de({},e),{apiVersion:1})),ke("Fast-forwarding runtime %o",e);var t=Ie(e);ke("Applying runtime %o",t),Ce=Y(t)}var Oe,Me="2.18.0",He=i("internal"),De=He.extend("ensureInitializeCalled"),Le=He.extend("ensureInitialized");function Ne(){if(!C.initializeCalled)throw De(h),new Error(h)}function Ue(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!C.initializeCompleted)throw Le("%s. initializeCalled: %s",h,C.initializeCalled.toString()),new Error(h);if(t&&t.length>0){for(var r=!1,o=0;o<t.length;o++)if(t[o]===C.frameContext){r=!0;break}if(!r)throw new Error("This call is only allowed in following contexts: ".concat(JSON.stringify(t),". ")+'Current context: "'.concat(C.frameContext,'".'))}return we(e)}function Ve(e){void 0===e&&(e=c);var t=$(C.clientSupportedSDKVersion,e);return!isNaN(t)&&t>=0}function xe(){return C.hostClientType==M.android||C.hostClientType==M.ios||C.hostClientType==M.ipados}function Be(e){if(void 0===e&&(e=c),!xe())throw{errorCode:k.NOT_SUPPORTED_ON_PLATFORM};if(!Ve(e))throw{errorCode:k.OLD_PLATFORM}}function We(e){var t=C.additionalValidOrigins.concat(e.filter((function(e){return"string"==typeof e&&p.test(e)}))),n={};t=t.filter((function(e){return!n[e]&&(n[e]=!0,!0)})),C.additionalValidOrigins=t}function ze(e){return null==e}!function(e){var t,n,r;function o(e){return new Promise((function(n,r){if(C.hostClientType===M.desktop||C.hostClientType===M.android||C.hostClientType===M.ios||C.hostClientType===M.ipados||C.hostClientType===M.macos||C.hostClientType===M.rigel||C.hostClientType===M.teamsRoomsWindows||C.hostClientType===M.teamsRoomsAndroid||C.hostClientType===M.teamsPhones||C.hostClientType===M.teamsDisplays||C.hostClientType===M.surfaceHub){var o=document.createElement("a");o.href=e.url,n(Xt("authentication.authenticate",[o.href,e.width,e.height,e.isExternal]).then((function(e){var t=e[0],n=e[1];if(t)return n;throw new Error(n)})))}else t={success:n,fail:r},c(e)}))}function i(e){return new Promise((function(t){t(Xt("authentication.getAuthToken",[null==e?void 0:e.resources,null==e?void 0:e.claims,null==e?void 0:e.silent]))})).then((function(e){var t=e[0],n=e[1];if(t)return n;throw new Error(n)}))}function a(){return new Promise((function(e){e(Xt("authentication.getUser"))})).then((function(e){var t=e[0],n=e[1];if(t)return n;throw new Error(n)}))}function s(){u();try{Ut.childWindow&&Ut.childWindow.close()}finally{Ut.childWindow=null,Ut.childOrigin=null}}function c(e){s();var t=e.width||600,n=e.height||400;t=Math.min(t,Ut.currentWindow.outerWidth-400),n=Math.min(n,Ut.currentWindow.outerHeight-200);var r=document.createElement("a");r.href=e.url.replace("{oauthRedirectMethod}","web");var o=void 0!==Ut.currentWindow.screenLeft?Ut.currentWindow.screenLeft:Ut.currentWindow.screenX,i=void 0!==Ut.currentWindow.screenTop?Ut.currentWindow.screenTop:Ut.currentWindow.screenY;o+=Ut.currentWindow.outerWidth/2-t/2,i+=Ut.currentWindow.outerHeight/2-n/2,Ut.childWindow=Ut.currentWindow.open(r.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+i+", left="+o+", width="+t+", height="+n),Ut.childWindow?l():f("FailedToOpenWindow")}function u(){n&&(clearInterval(n),n=0),Tt("initialize"),Tt("navigateCrossDomain")}function l(){u(),n=Ut.currentWindow.setInterval((function(){if(!Ut.childWindow||Ut.childWindow.closed)f("CancelledByUser");else{var e=Ut.childOrigin;try{Ut.childOrigin="*",Pn("ping")}finally{Ut.childOrigin=e}}}),100),It("initialize",(function(){return[D.authentication,C.hostClientType]})),It("navigateCrossDomain",(function(){return!1}))}function d(e){try{t&&t.success(e)}finally{t=void 0,s()}}function f(e){try{t&&t.fail(new Error(e))}finally{t=void 0,s()}}function p(e,t,n){if(e){var r=document.createElement("a");r.href=decodeURIComponent(e),r.host&&r.host!==ue().location.host&&"outlook.office.com"===r.host&&r.search.indexOf("client_type=Win32_Outlook")>-1&&(t&&"result"===t&&(n&&(r.href=g(r.href,"result",n)),Ut.currentWindow.location.assign(g(r.href,"authSuccess",""))),t&&"reason"===t&&(n&&(r.href=g(r.href,"reason",n)),Ut.currentWindow.location.assign(g(r.href,"authFailure",""))))}}function g(e,t,n){var r=e.indexOf("#"),o=-1===r?"#":e.substr(r);return o=o+"&"+t+(""!==n?"="+n:""),(e=-1===r?e:e.substr(0,r))+o}e.initialize=function(){It("authentication.authenticate.success",d,!1),It("authentication.authenticate.failure",f,!1)},e.registerAuthenticationHandlers=function(e){r=e},e.authenticate=function(e){var t=void 0!==e,n=t?e:r;if(!n)throw new Error("No parameters are provided for authentication");return Ue(Ce,D.content,D.sidePanel,D.settings,D.remove,D.task,D.stage,D.meetingStage),o(n).then((function(e){try{return n&&n.successCallback?(n.successCallback(e),""):e}finally{t||(r=void 0)}})).catch((function(e){try{if(n&&n.failureCallback)return n.failureCallback(e.message),"";throw e}finally{t||(r=void 0)}}))},e.getAuthToken=function(e){return Ne(),i(e).then((function(t){return e&&e.successCallback?(e.successCallback(t),""):t})).catch((function(t){if(e&&e.failureCallback)return e.failureCallback(t.message),"";throw t}))},e.getUser=function(e){return Ne(),a().then((function(t){return e&&e.successCallback?(e.successCallback(t),null):t})).catch((function(t){if(e&&e.failureCallback)return e.failureCallback(t.message),null;throw t}))},e.notifySuccess=function(e,t){p(t,"result",e),Ue(Ce,D.authentication),Yt("authentication.authenticate.success",[e]),yn(Ut.parentWindow,(function(){return setTimeout((function(){return Ut.currentWindow.close()}),200)}))},e.notifyFailure=function(e,t){p(t,"reason",e),Ue(Ce,D.authentication),Yt("authentication.authenticate.failure",[e]),yn(Ut.parentWindow,(function(){return setTimeout((function(){return Ut.currentWindow.close()}),200)}))},function(e){e.Public="public",e.EUDB="eudb",e.Other="other"}(e.DataResidency||(e.DataResidency={}))}(Oe||(Oe={}));var Ge,je,qe=e.V_2;function Je(e,t){if(Ue(Ce,D.content,D.sidePanel,D.task,D.meetingStage),!Ge.update.isSupported())throw B;Qt(e,"tasks.updateTask",[t])}function Ke(e,t,n,r){if(Ue(Ce,D.content,D.sidePanel,D.meetingStage),!Ge.url.isSupported())throw B;r&&It("messageForParent",r),Qt(e,"tasks.startTask",[Ge.url.getDialogInfoFromUrlDialogInfo(t)],(function(e,t){null==n||n({err:e,result:t}),Tt("messageForParent")}))}function Ze(e,t,n,r){if(Ue(Ce,D.content,D.sidePanel,D.meetingStage),!Ge.url.bot.isSupported())throw B;r&&It("messageForParent",r),Qt(e,"tasks.startTask",[Ge.url.getDialogInfoFromBotUrlDialogInfo(t)],(function(e,t){null==n||n({err:e,result:t}),Tt("messageForParent")}))}function Xe(e,t,n){if(Ue(Ce,D.content,D.task),!Ge.url.isSupported())throw B;Qt(e,"tasks.completeTask",[t,n?Array.isArray(n)?n:[n]:[]])}!function(e){var n=[];function r(e){C.frameContext&&(C.frameContext===D.task?n.push(e):Tt("messageForChild"))}e.initialize=function(){It("messageForChild",r,!1)},function(e){function r(){return Ue(Ce)&&void 0!==(Ce.supports.dialog&&Ce.supports.dialog.url)}function o(e){return{url:e.url,height:e.size?e.size.height:U.Small,width:e.size?e.size.width:U.Small,title:e.title,fallbackUrl:e.fallbackUrl}}e.open=function(e,n,r){Ke(a(qe,t.Dialog_Url_Open),e,n,r)},e.submit=function(e,n){Xe(a(qe,t.Dialog_Url_Submit),e,n)},e.sendMessageToParentFromDialog=function(e){if(Ue(Ce,D.task),!r())throw B;Qt(a(qe,t.Dialog_Url_SendMessageToParentFromDialog),"messageForParent",[e])},e.sendMessageToDialog=function(e){if(Ue(Ce,D.content,D.sidePanel,D.meetingStage),!r())throw B;Qt(a(qe,t.Dialog_Url_SendMessageToDialog),"messageForChild",[e])},e.registerOnMessageFromParent=function(e){if(Ue(Ce,D.task),!r())throw B;for(Tt("messageForChild"),It("messageForChild",e),n.reverse();n.length>0;){e(n.pop())}},e.isSupported=r,function(e){e.open=function(e,n,r){Ze(a(qe,t.Dialog_Url_Bot_Open),e,n,r)},e.isSupported=function(){return Ue(Ce)&&void 0!==(Ce.supports.dialog&&Ce.supports.dialog.url&&Ce.supports.dialog.url.bot)}}(e.bot||(e.bot={})),e.getDialogInfoFromUrlDialogInfo=o,e.getDialogInfoFromBotUrlDialogInfo=function(e){var t=o(e);return t.completionBotId=e.completionBotId,t}}(e.url||(e.url={})),e.isSupported=function(){return!(!Ue(Ce)||!Ce.supports.dialog)},function(e){e.resize=function(e){Je(a(qe,t.Dialog_Update_Resize),e)},e.isSupported=function(){return!(!Ue(Ce)||!Ce.supports.dialog)&&!!Ce.supports.dialog.update}}(e.update||(e.update={})),function(e){function n(){var e=Ce.hostVersionsInfo&&Ce.hostVersionsInfo.adaptiveCardSchemaVersion&&!ie(Ce.hostVersionsInfo.adaptiveCardSchemaVersion);return Ue(Ce)&&void 0!==(e&&Ce.supports.dialog&&Ce.supports.dialog.card)}function r(e){return{card:e.card,height:e.size?e.size.height:U.Small,width:e.size?e.size.width:U.Small,title:e.title}}function o(e){var t=r(e);return t.completionBotId=e.completionBotId,t}e.open=function(e,o){if(Ue(Ce,D.content,D.sidePanel,D.meetingStage),!n())throw B;var i=r(e);Qt(a(qe,t.Dialog_AdaptiveCard_Open),"tasks.startTask",[i],(function(e,t){null==o||o({err:e,result:t})}))},e.isSupported=n,function(e){function n(){var e=Ce.hostVersionsInfo&&Ce.hostVersionsInfo.adaptiveCardSchemaVersion&&!ie(Ce.hostVersionsInfo.adaptiveCardSchemaVersion);return Ue(Ce)&&void 0!==(e&&Ce.supports.dialog&&Ce.supports.dialog.card&&Ce.supports.dialog.card.bot)}e.open=function(e,r){if(Ue(Ce,D.content,D.sidePanel,D.meetingStage),!n())throw B;var i=o(e);Qt(a(qe,t.Dialog_AdaptiveCard_Bot_Open),"tasks.startTask",[i],(function(e,t){null==r||r({err:e,result:t})}))},e.isSupported=n}(e.bot||(e.bot={}))}(e.adaptiveCard||(e.adaptiveCard={}))}(Ge||(Ge={})),function(e){!function(e){e[e.ifRoom=0]="ifRoom",e[e.overflowOnly=1]="overflowOnly"}(e.DisplayMode||(e.DisplayMode={}));var t,n,r,o=function(){return function(){this.enabled=!0,this.selected=!1}}();function i(e){r&&r(e)||(Ue(Ce),Yt("viewConfigItemPress",[e]))}function a(e){t&&t(e)||(Ue(Ce),Yt("handleNavBarMenuItemPress",[e]))}function s(e){n&&n(e)||(Ue(Ce),Yt("handleActionMenuItemPress",[e]))}function c(){return!(!Ue(Ce)||!Ce.supports.menus)}e.MenuItem=o,function(e){e.dropDown="dropDown",e.popOver="popOver"}(e.MenuListType||(e.MenuListType={})),e.initialize=function(){It("navBarMenuItemPress",a,!1),It("actionMenuItemPress",s,!1),It("setModuleView",i,!1)},e.setUpViews=function(e,t){if(Ue(Ce),!c())throw B;r=t,Yt("setUpViews",[e])},e.setNavBarMenu=function(e,n){if(Ue(Ce),!c())throw B;t=n,Yt("setNavBarMenu",[e])},e.showActionMenu=function(e,t){if(Ue(Ce),!c())throw B;n=t,Yt("showActionMenu",[e])},e.isSupported=c}(je||(je={}));var $e=e.V_2,Qe=5e3,Ye=i("app");function et(e,t){return le()?(Ye.extend("initialize")("window object undefined at initialization"),Promise.resolve()):re((function(){return rt(e,t)}),Qe,new Error("SDK initialization timed out."))}var tt,nt=Ye.extend("initializeHelper");function rt(e,t){return new Promise((function(n){C.initializeCalled||(C.initializeCalled=!0,bt(),C.initializePromise=xt(t,e).then((function(e){var t=e.context,n=e.clientType,r=e.runtimeConfig,o=e.clientSupportedSDKVersion,i=void 0===o?c:o;C.frameContext=t,C.hostClientType=n,C.clientSupportedSDKVersion=i;try{nt("Parsing %s",r);var a=JSON.parse(r);if(nt("Checking if %o is a valid runtime object",null!=a?a:"null"),!a||!a.apiVersion)throw new Error("Received runtime config is invalid");r&&Re(a)}catch(e){if(!(e instanceof SyntaxError))throw e;try{nt("Attempting to parse %s as an SDK version",r),isNaN($(r,c))||(C.clientSupportedSDKVersion=r);a=JSON.parse(i);if(nt("givenRuntimeConfig parsed to %o",null!=a?a:"null"),!a)throw new Error("givenRuntimeConfig string was successfully parsed. However, it parsed to value of null");Re(a)}catch(e){if(!(e instanceof SyntaxError))throw e;Re(Ae(C.clientSupportedSDKVersion,be,Ee))}}C.initializeCompleted=!0})),Oe.initialize(),je.initialize(),st.config.initialize(),Ge.initialize()),Array.isArray(t)&&We(t),void 0!==C.initializePromise?n(C.initializePromise):nt("GlobalVars.initializePromise is unexpectedly undefined")}))}function ot(e,t){!ze(t)&&Ne(),_t(e,t)}function it(e,t){return new Promise((function(n){Ue(Ce,D.content,D.sidePanel,D.settings,D.task,D.stage,D.meetingStage),n(Gt(e,"executeDeepLink",t))}))}function at(e){var t;return{actionInfo:e.actionInfo,app:{locale:e.locale,sessionId:e.appSessionId?e.appSessionId:"",theme:e.theme?e.theme:"default",iconPositionVertical:e.appIconPosition,osLocaleInfo:e.osLocaleInfo,parentMessageId:e.parentMessageId,userClickTime:e.userClickTime,userFileOpenPreference:e.userFileOpenPreference,host:{name:e.hostName?e.hostName:H.teams,clientType:e.hostClientType?e.hostClientType:M.web,sessionId:e.sessionId?e.sessionId:"",ringId:e.ringId},appLaunchId:e.appLaunchId},page:{id:e.entityId,frameContext:e.frameContext?e.frameContext:C.frameContext,subPageId:e.subEntityId,isFullScreen:e.isFullScreen,isMultiWindow:e.isMultiWindow,sourceOrigin:e.sourceOrigin},user:{id:null!==(t=e.userObjectId)&&void 0!==t?t:"",displayName:e.userDisplayName,isCallingAllowed:e.isCallingAllowed,isPSTNCallingAllowed:e.isPSTNCallingAllowed,licenseType:e.userLicenseType,loginHint:e.loginHint,userPrincipalName:e.userPrincipalName,tenant:e.tid?{id:e.tid,teamsSku:e.tenantSKU}:void 0},channel:e.channelId?{id:e.channelId,displayName:e.channelName,relativeUrl:e.channelRelativeUrl,membershipType:e.channelType,defaultOneNoteSectionId:e.defaultOneNoteSectionId,ownerGroupId:e.hostTeamGroupId,ownerTenantId:e.hostTeamTenantId}:void 0,chat:e.chatId?{id:e.chatId}:void 0,meeting:e.meetingId?{id:e.meetingId}:void 0,sharepoint:e.sharepoint,team:e.teamId?{internalId:e.teamId,displayName:e.teamName,type:e.teamType,groupId:e.groupId,templateId:e.teamTemplateId,isArchived:e.isTeamArchived,userRole:e.userTeamRole}:void 0,sharePointSite:e.teamSiteUrl||e.teamSiteDomain||e.teamSitePath||e.mySitePath||e.mySiteDomain?{teamSiteUrl:e.teamSiteUrl,teamSiteDomain:e.teamSiteDomain,teamSitePath:e.teamSitePath,teamSiteId:e.teamSiteId,mySitePath:e.mySitePath,mySiteDomain:e.mySiteDomain}:void 0}}!function(e){var n=i("app");e.Messages={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"},function(e){e.AuthFailed="AuthFailed",e.Timeout="Timeout",e.Other="Other"}(e.FailedReason||(e.FailedReason={})),function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"}(e.ExpectedFailureReason||(e.ExpectedFailureReason={})),e.isInitialized=function(){return C.initializeCompleted},e.getFrameContext=function(){return C.frameContext},function(){if(!le()){var e=document.getElementsByTagName("script"),t=e&&e[e.length-1]&&e[e.length-1].src,r="Today, teamsjs can only be used from a single script or you may see undefined behavior. This log line is used to help detect cases where teamsjs is loaded multiple times -- it is always written. The presence of the log itself does not indicate a multi-load situation, but multiples of these log lines will. If you would like to use teamjs from more than one script at the same time, please open an issue at https://github.com/OfficeDev/microsoft-teams-library-js/issues";t&&0!==t.length?n("teamsjs is being used from %s. %s",t,r):n("teamsjs is being used from a script tag embedded directly in your html. %s",r)}}(),e.initialize=function(e){return et(a($e,t.App_Initialize),e)},e._initialize=function(e){Ut.currentWindow=e},e._uninitialize=function(){C.initializeCalled&&(yt(),C.initializeCalled=!1,C.initializeCompleted=!1,C.initializePromise=void 0,C.additionalValidOrigins=[],C.frameContext=void 0,C.hostClientType=void 0,C.isFramelessWindow=!1,Bt())},e.getContext=function(){return new Promise((function(e){Ne(),e(Wt(a($e,t.App_GetContext),"getContext"))})).then((function(e){return at(e)}))},e.notifyAppLoaded=function(){Ne(),Qt(a($e,t.App_NotifyAppLoaded),e.Messages.AppLoaded,[Me])},e.notifySuccess=function(){Ne(),Qt(a($e,t.App_NotifySuccess),e.Messages.Success,[Me])},e.notifyFailure=function(n){Ne(),Qt(a($e,t.App_NotifyFailure),e.Messages.Failure,[n.reason,n.message])},e.notifyExpectedFailure=function(n){Ne(),Qt(a($e,t.App_NotifyExpectedFailure),e.Messages.ExpectedFailure,[n.reason,n.message])},e.registerOnThemeChangeHandler=function(e){ot(a($e,t.App_RegisterOnThemeChangeHandler),e)},e.openLink=function(e){return it(a($e,t.App_OpenLink),e)},function(e){e.registerBeforeSuspendOrTerminateHandler=function(e){if(!e)throw new Error("[app.lifecycle.registerBeforeSuspendOrTerminateHandler] Handler cannot be null");Ue(Ce),Ht(e)},e.registerOnResumeHandler=function(e){if(!e)throw new Error("[app.lifecycle.registerOnResumeHandler] Handler cannot be null");Ue(Ce),Dt(e)}}(e.lifecycle||(e.lifecycle={}))}(tt||(tt={}));var st,ct=e.V_2;function ut(e,t){return new Promise((function(n){if(Ue(Ce,D.content,D.sidePanel,D.settings,D.remove,D.task,D.stage,D.meetingStage),!st.isSupported())throw B;n(qt(e,"navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",t))}))}function lt(e){return new Promise((function(t){if(Ue(Ce),!st.backStack.isSupported())throw B;t(qt(e,"navigateBack","Back navigation is not supported in the current client or context."))}))}function dt(e,t){return new Promise((function(n){if(Ue(Ce),!st.tabs.isSupported())throw B;n(qt(e,"navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",t))}))}function ft(e,t){if(Ue(Ce),!st.isSupported())throw B;Qt(e,"returnFocus",[t])}function pt(e,t){return new Promise((function(n){if(Ue(Ce),!st.tabs.isSupported())throw B;n(Wt(e,"getTabInstances",t))}))}function gt(e,t){return new Promise((function(n){if(Ue(Ce),!st.tabs.isSupported())throw B;n(Wt(e,"getMruTabInstances",t))}))}function mt(e,t){if(Ue(Ce,D.content,D.sidePanel,D.meetingStage),!st.isSupported())throw B;Qt(e,"shareDeepLink",[t.subPageId,t.subPageLabel,t.subPageWebUrl])}function ht(e,t){if(Ue(Ce,D.content),!st.isSupported())throw B;Qt(e,"setFrameContext",[t])}!function(e){function n(e){ht(a(ct,t.Pages_SetCurrentFrame),e)}function r(){return!(!Ue(Ce)||!Ce.supports.pages)}e.returnFocus=function(e){ft(a(ct,t.Pages_ReturnFocus),e)},e.registerFocusEnterHandler=function(e){Ft(a(ct,t.Pages_RegisterFocusEnterHandler),"focusEnter",e,[],(function(){if(!r())throw B}))},e.setCurrentFrame=n,e.initializeWithFrameContext=function(e,t,r){tt.initialize(r).then((function(){return t&&t()})),n(e)},e.getConfig=function(){return new Promise((function(e){if(Ue(Ce,D.content,D.settings,D.remove,D.sidePanel),!r())throw B;e(Wt(a(ct,t.Pages_GetConfig),"settings.getSettings"))}))},e.navigateCrossDomain=function(e){return ut(a(ct,t.Pages_NavigateCrossDomain),e)},e.navigateToApp=function(e){return new Promise((function(n){if(Ue(Ce,D.content,D.sidePanel,D.settings,D.task,D.stage,D.meetingStage),!r())throw B;var o=a(ct,t.Pages_NavigateCrossDomain);Ce.isLegacyTeams?n(Gt(o,"executeDeepLink",oe(e))):n(Gt(o,"pages.navigateToApp",e))}))},e.shareDeepLink=function(e){return mt(a(ct,t.Pages_ShareDeepLink),e)},e.registerFullScreenHandler=function(e){Ft(a(ct,t.Pages_RegisterFullScreenHandler),"fullScreenChange",e,[],(function(){if(!ze(e)&&!r())throw B}))},e.isSupported=r,function(e){e.navigateToTab=function(e){return dt(a(ct,t.Pages_Tabs_NavigateToTab),e)},e.getTabInstances=function(e){return pt(a(ct,t.Pages_Tabs_GetTabInstances),e)},e.getMruTabInstances=function(e){return gt(a(ct,t.Pages_Tabs_GetMruTabInstances),e)},e.isSupported=function(){return!(!Ue(Ce)||!Ce.supports.pages)&&!!Ce.supports.pages.tabs}}(e.tabs||(e.tabs={})),function(e){var n,r;function o(e,r){!ze(e)&&Ue(Ce,D.settings),r&&r(),n=e,!ze(e)&&Qt(a(ct,t.Pages_Config_RegisterOnSaveHandlerHelper),"registerHandler",["save"])}function i(e,n){!ze(e)&&Ue(Ce,D.remove,D.settings),n&&n(),r=e,!ze(e)&&Qt(a(ct,t.Pages_Config_RegisterOnRemoveHandlerHelper),"registerHandler",["remove"])}function s(e){var t=new c(e);n?n(t):Ut.childWindow?Pn("settings.save",[e]):t.notifySuccess()}e.initialize=function(){It("settings.save",s,!1),It("settings.remove",u,!1)},e.setValidityState=function(e){if(Ue(Ce,D.settings,D.remove),!d())throw B;Qt(a(ct,t.Pages_Config_SetValidityState),"settings.setValidityState",[e])},e.setConfig=function(e){return new Promise((function(n){if(Ue(Ce,D.content,D.settings,D.sidePanel),!d())throw B;n(Gt(a(ct,t.Pages_Config_SetConfig),"settings.setSettings",e))}))},e.registerOnSaveHandler=function(e){o(e,(function(){if(!ze(e)&&!d())throw B}))},e.registerOnSaveHandlerHelper=o,e.registerOnRemoveHandler=function(e){i(e,(function(){if(!ze(e)&&!d())throw B}))},e.registerOnRemoveHandlerHelper=i,e.registerChangeConfigHandler=function(e){Ft(a(ct,t.Pages_Config_RegisterChangeConfigHandler),"changeSettings",e,[D.content],(function(){if(!d())throw B}))};var c=function(){function e(e){this.notified=!1,this.result=e||{}}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),Qt(a(ct,t.Settings_Save_Success),"settings.save.success"),this.notified=!0},e.prototype.notifyFailure=function(e){this.ensureNotNotified(),Qt(a(ct,t.Settings_Save_Failure),"settings.save.failure",[e]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},e}();function u(){var e=new l;r?r(e):Ut.childWindow?Pn("settings.remove",[]):e.notifySuccess()}var l=function(){function e(){this.notified=!1}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),Qt(a(ct,t.Settings_Remove_Success),"settings.remove.success"),this.notified=!0},e.prototype.notifyFailure=function(e){this.ensureNotNotified(),Qt(a(ct,t.Settings_Remove_Failure),"settings.remove.failure",[e]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEventType may only notify success or failure once.")},e}();function d(){return!(!Ue(Ce)||!Ce.supports.pages)&&!!Ce.supports.pages.config}e.isSupported=d}(e.config||(e.config={})),function(e){var n;function r(){return lt(a(ct,t.Pages_BackStack_NavigateBack))}function o(e,t,r){!ze(t)&&Ue(Ce),r&&r(),n=t,!ze(t)&&Qt(e,"registerHandler",["backButton"])}function i(){n&&n()||(Ut.childWindow?Pn("backButtonPress",[]):r())}function s(){return!(!Ue(Ce)||!Ce.supports.pages)&&!!Ce.supports.pages.backStack}e._initialize=function(){It("backButtonPress",i,!1)},e.navigateBack=r,e.registerBackButtonHandler=function(e){o(a(ct,t.Pages_BackStack_RegisterBackButtonHandler),e,(function(){if(!ze(e)&&!s())throw B}))},e.registerBackButtonHandlerHelper=o,e.isSupported=s}(e.backStack||(e.backStack={})),function(e){function n(){return!(!Ue(Ce)||!Ce.supports.pages)&&!!Ce.supports.pages.fullTrust}e.enterFullscreen=function(){if(Ue(Ce,D.content),!n())throw B;Qt(a(ct,t.Pages_FullTrust_EnterFullscreen),"enterFullscreen",[])},e.exitFullscreen=function(){if(Ue(Ce,D.content),!n())throw B;Qt(a(ct,t.Pages_FullTrust_ExitFullscreen),"exitFullscreen",[])},e.isSupported=n}(e.fullTrust||(e.fullTrust={})),function(e){function n(){return!(!Ue(Ce)||!Ce.supports.pages)&&!!Ce.supports.pages.appButton}e.onClick=function(e){Ft(a(ct,t.Pages_AppButton_OnClick),"appButtonClick",e,[D.content],(function(){if(!n())throw B}))},e.onHoverEnter=function(e){Ft(a(ct,t.Pages_AppButton_OnHoverEnter),"appButtonHoverEnter",e,[D.content],(function(){if(!n())throw B}))},e.onHoverLeave=function(e){Ft(a(ct,t.Pages_AppButton_OnHoverLeave),"appButtonHoverLeave",e,[D.content],(function(){if(!n())throw B}))},e.isSupported=n}(e.appButton||(e.appButton={})),function(e){function n(){return!(!Ue(Ce)||!Ce.supports.pages)&&!!Ce.supports.pages.currentApp}e.navigateTo=function(e){return new Promise((function(r){if(Ue(Ce,D.content,D.sidePanel,D.settings,D.task,D.stage,D.meetingStage),!n())throw B;r(Jt(a(ct,t.Pages_CurrentApp_NavigateTo),"pages.currentApp.navigateTo",e))}))},e.navigateToDefaultPage=function(){return new Promise((function(e){if(Ue(Ce,D.content,D.sidePanel,D.settings,D.task,D.stage,D.meetingStage),!n())throw B;e(Jt(a(ct,t.Pages_CurrentApp_NavigateToDefaultPage),"pages.currentApp.navigateToDefaultPage"))}))},e.isSupported=n}(e.currentApp||(e.currentApp={}))}(st||(st={}));var vt=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},wt=i("handlers"),Ct=function(){function e(){}return e.initializeHandlers=function(){e.handlers.themeChange=At,e.handlers.load=Rt,e.handlers.beforeUnload=Mt,st.backStack._initialize()},e.uninitializeHandlers=function(){e.handlers={},e.themeChangeHandler=null,e.loadHandler=null,e.beforeUnloadHandler=null,e.beforeSuspendOrTerminateHandler=null,e.resumeHandler=null},e.handlers={},e.themeChangeHandler=null,e.loadHandler=null,e.beforeUnloadHandler=null,e.beforeSuspendOrTerminateHandler=null,e.resumeHandler=null,e}();function bt(){Ct.initializeHandlers()}function yt(){Ct.uninitializeHandlers()}var St=wt.extend("callHandler");function Pt(e,t){var n=Ct.handlers[e];return n?(St("Invoking the registered handler for message %s with arguments %o",e,t),[!0,n.apply(this,t)]):Ut.childWindow?(Pn(e,t),[!1,void 0]):(St("Handler for action message %s not found.",e),[!1,void 0])}function It(n,r,o,i){void 0===o&&(o=!0),void 0===i&&(i=[]),r?(Ct.handlers[n]=r,o&&Qt(a(e.V_0,t.RegisterHandler),"registerHandler",vt([n],i,!0))):delete Ct.handlers[n]}function Tt(e){delete Ct.handlers[e]}function Et(e){return null!=Ct.handlers[e]}function Ft(e,t,n,r,o){n&&Ue.apply(void 0,vt([Ce],r,!1)),o&&o(),It(t,n)}function _t(e,t){Ct.themeChangeHandler=t,!ze(t)&&Qt(e,"registerHandler",["themeChange"])}function At(e){Ct.themeChangeHandler&&Ct.themeChangeHandler(e),Ut.childWindow&&Pn("themeChange",[e])}function kt(n){Ct.loadHandler=n,!ze(n)&&Qt(a(e.V_2,t.RegisterHandler),"registerHandler",["load"])}function Rt(e){Ct.resumeHandler?Ct.resumeHandler(e):Ct.loadHandler&&Ct.loadHandler(e),Ut.childWindow&&Pn("load",[e])}function Ot(n){Ct.beforeUnloadHandler=n,!ze(n)&&Qt(a(e.V_2,t.RegisterHandler),"registerHandler",["beforeUnload"])}function Mt(){var e=function(){Yt("readyToUnload",[])};Ct.beforeSuspendOrTerminateHandler?(Ct.beforeSuspendOrTerminateHandler(),Ut.childWindow?Pn("beforeUnload"):e()):Ct.beforeUnloadHandler&&Ct.beforeUnloadHandler(e)||(Ut.childWindow?Pn("beforeUnload"):e())}function Ht(e){Ct.beforeSuspendOrTerminateHandler=e,!ze(e)&&Yt("registerHandler",["beforeUnload"])}function Dt(e){Ct.resumeHandler=e,!ze(e)&&Yt("registerHandler",["load"])}var Lt=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Nt=i("communication"),Ut=function(){return function(){}}(),Vt=function(){function e(){}return e.parentMessageQueue=[],e.childMessageQueue=[],e.nextMessageId=0,e.callbacks={},e.promiseCallbacks={},e}();function xt(e,t){if(Vt.messageListener=function(e){return rn(e)},Ut.currentWindow=Ut.currentWindow||ue(),Ut.parentWindow=Ut.currentWindow.parent!==Ut.currentWindow.self?Ut.currentWindow.parent:Ut.currentWindow.opener,(Ut.parentWindow||e)&&Ut.currentWindow.addEventListener("message",Vt.messageListener,!1),!Ut.parentWindow){var n=Ut.currentWindow;if(!n.nativeInterface)return Promise.reject(new Error("Initialization Failed. No Parent window found."));C.isFramelessWindow=!0,n.onNativeMessage=un}try{return Ut.parentOrigin="*",Zt(t,"initialize",[Me,me]).then((function(e){return{context:e[0],clientType:e[1],runtimeConfig:e[2],clientSupportedSDKVersion:e[3]}}))}finally{Ut.parentOrigin=null}}function Bt(){Ut.currentWindow&&Ut.currentWindow.removeEventListener("message",Vt.messageListener,!1),Ut.currentWindow=null,Ut.parentWindow=null,Ut.parentOrigin=null,Ut.childWindow=null,Ut.childOrigin=null,Vt.parentMessageQueue=[],Vt.childMessageQueue=[],Vt.nextMessageId=0,Vt.callbacks={},Vt.promiseCallbacks={}}function Wt(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return Zt(e,t,n).then((function(e){return e[0]}))}function zt(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Xt(e,t).then((function(e){return e[0]}))}function Gt(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return Zt(e,t,n).then((function(e){var t=e[0],n=e[1];if(!t)throw new Error(n)}))}function jt(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Xt(e,t).then((function(e){var t=e[0],n=e[1];if(!t)throw new Error(n)}))}function qt(e,t,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];return Zt(e,t,r).then((function(e){var t=e[0],r=e[1];if(!t)throw new Error(r||n)}))}function Jt(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return Zt(e,t,n).then((function(e){var t=e[0],n=e[1];if(t)throw t;return n}))}function Kt(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Xt(e,t).then((function(e){var t=e[0],n=e[1];if(t)throw t;return n}))}function Zt(e,t,n){if(void 0===n&&(n=void 0),!s(e))throw Error("apiVersionTag: ".concat(e," passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check."));return new Promise((function(r){r($t(tn(e,t,n).id))}))}function Xt(t,n){return void 0===n&&(n=void 0),new Promise((function(r){r($t(tn(a(e.V_0,"testing"),t,n).id))}))}function $t(e){return new Promise((function(t){Vt.promiseCallbacks[e]=t}))}function Qt(e,t,n,r){var o;if(n instanceof Function?r=n:n instanceof Array&&(o=n),!s(e))throw Error("apiVersionTag: ".concat(e," passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check."));var i=tn(e,t,o);r&&(Vt.callbacks[i.id]=r)}function Yt(t,n,r){var o;n instanceof Function?r=n:n instanceof Array&&(o=n);var i=tn(a(e.V_0,"testing"),t,o);r&&(Vt.callbacks[i.id]=r)}var en=Nt.extend("sendMessageToParentHelper");function tn(e,t,n){var r=en,o=Ut.parentWindow,i=In(e,t,n);if(r("Message %i information: %o",i.id,{actionName:t,args:n}),C.isFramelessWindow)Ut.currentWindow&&Ut.currentWindow.nativeInterface&&(r("Sending message %i to parent via framelessPostMessage interface",i.id),Ut.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(i)));else{var a=pn(o);o&&a?(r("Sending message %i to parent via postMessage",i.id),o.postMessage(i,a)):(r("Adding message %i to parent message queue",i.id),fn(o).push(i))}return i}var nn=Nt.extend("processMessage");function rn(e){if(e&&e.data&&"object"==typeof e.data){var t=e.source||e.originalEvent&&e.originalEvent.source,n=e.origin||e.originalEvent&&e.originalEvent.origin;an(t,n)?(sn(t,n),t===Ut.parentWindow?un(e):t===Ut.childWindow&&dn(e)):nn("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin")}else nn("Unrecognized message format received by app, message being ignored. Message: %o",e)}var on=Nt.extend("shouldProcessMessage");function an(e,t){if(Ut.currentWindow&&e===Ut.currentWindow)return on("Should not process message because it is coming from the current window"),!1;if(Ut.currentWindow&&Ut.currentWindow.location&&t&&t===Ut.currentWindow.location.origin)return!0;var n=Z(new URL(t));return n||on("Message has an invalid origin of %s",t),n}function sn(e,t){C.isFramelessWindow||Ut.parentWindow&&!Ut.parentWindow.closed&&e!==Ut.parentWindow?Ut.childWindow&&!Ut.childWindow.closed&&e!==Ut.childWindow||(Ut.childWindow=e,Ut.childOrigin=t):(Ut.parentWindow=e,Ut.parentOrigin=t),Ut.parentWindow&&Ut.parentWindow.closed&&(Ut.parentWindow=null,Ut.parentOrigin=null),Ut.childWindow&&Ut.childWindow.closed&&(Ut.childWindow=null,Ut.childOrigin=null),bn(Ut.parentWindow),bn(Ut.childWindow)}var cn=Nt.extend("handleParentMessage");function un(e){var t=cn;if("id"in e.data&&"number"==typeof e.data.id){var n=e.data,r=Vt.callbacks[n.id];t("Received a response from parent for message %i",n.id),r&&(t("Invoking the registered callback for message %i with arguments %o",n.id,n.args),r.apply(null,Lt(Lt([],n.args,!0),[n.isPartialResponse],!1)),ln(e)||(t("Removing registered callback for message %i",n.id),delete Vt.callbacks[n.id]));var o=Vt.promiseCallbacks[n.id];o&&(t("Invoking the registered promise callback for message %i with arguments %o",n.id,n.args),o(n.args),t("Removing registered promise callback for message %i",n.id),delete Vt.promiseCallbacks[n.id])}else if("func"in e.data&&"string"==typeof e.data.func){t("Received an action message %s from parent",(n=e.data).func),Pt(n.func,n.args)}else t("Received an unknown message: %O",e)}function ln(e){return!0===e.data.isPartialResponse}function dn(e){if("id"in e.data&&"func"in e.data){var t=e.data,n=Pt(t.func,t.args),r=n[0],o=n[1];r&&void 0!==o?Sn(t.id,Array.isArray(o)?o:[o]):Yt(t.func,t.args,(function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(Ut.childWindow){var r=e.pop();Sn(t.id,e,r)}}))}}function fn(e){return e===Ut.parentWindow?Vt.parentMessageQueue:e===Ut.childWindow?Vt.childMessageQueue:[]}function pn(e){return e===Ut.parentWindow?Ut.parentOrigin:e===Ut.childWindow?Ut.childOrigin:null}var gn,mn,hn,vn,wn,Cn=Nt.extend("flushMessageQueue");function bn(e){for(var t=pn(e),n=fn(e),r=e==Ut.parentWindow?"parent":"child";e&&t&&n.length>0;){var o=n.shift();Cn("Flushing message %i from "+r+" message queue via postMessage.",null==o?void 0:o.id),e.postMessage(o,t)}}function yn(e,t){var n=Ut.currentWindow.setInterval((function(){0===fn(e).length&&(clearInterval(n),t())}),100)}function Sn(e,t,n){var r=Ut.childWindow,o=Tn(e,t,n),i=pn(r);r&&i&&r.postMessage(o,i)}function Pn(e,t){var n=Ut.childWindow,r=En(e,t),o=pn(n);n&&o?n.postMessage(r,o):fn(n).push(r)}function In(e,t,n){return{id:Vt.nextMessageId++,func:t,timestamp:Date.now(),args:n||[],apiversiontag:e}}function Tn(e,t,n){return{id:e,args:t||[],isPartialResponse:n}}function En(e,t){return{func:e,args:t||[]}}function Fn(e,t){Ue(Ce),Yt("uploadCustomApp",[e],t||X())}function _n(e,t,n){Ue(Ce),Yt(e,t,n)}function An(e,t){if(Ue(Ce),!Ut.childWindow)throw new Error("The child window has not yet been initialized or is not present");Pn(e,t)}function kn(e,t){var n=this;Ue(Ce),It(e,(function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.apply(n,e)}))}function Rn(e,t){Ue(Ce),It("userSettingsChange",t,!0,[e])}function On(e){Ue(Ce,D.content,D.task),Yt("openFilePreview",[e.entityId,e.title,e.description,e.type,e.objectUrl,e.downloadUrl,e.webPreviewUrl,e.webEditUrl,e.baseUrl,e.editFile,e.subEntityId,e.viewerAction,e.fileOpenPreference,e.conversationId])}!function(e){function t(){return!(!Ue(Ce)||!Ce.supports.logs)}e.registerGetLogHandler=function(e){if(!ze(e)&&Ue(Ce),!ze(e)&&!t())throw B;e?It("log.request",(function(){Yt("log.receive",[e()])})):Tt("log.request")},e.isSupported=t}(gn||(gn={})),function(e){e.fileDownloadStart="fileDownloadStart",e.fileDownloadComplete="fileDownloadComplete"}(mn||(mn={})),function(e){e.view="view",e.edit="edit",e.editNew="editNew"}(hn||(hn={})),function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"}(vn||(vn={})),function(e){function t(){return!(!Ue(Ce)||!Ce.supports.conversations)}e.openConversation=function(e){return new Promise((function(n){if(Ue(Ce,D.content),!t())throw B;var r=jt("conversations.openConversation",{title:e.title,subEntityId:e.subEntityId,conversationId:e.conversationId,channelId:e.channelId,entityId:e.entityId});e.onStartConversation&&It("startConversation",(function(t,n,r,o){var i;return null===(i=e.onStartConversation)||void 0===i?void 0:i.call(e,{subEntityId:t,conversationId:n,channelId:r,entityId:o})})),e.onCloseConversation&&It("closeConversation",(function(t,n,r,o){var i;return null===(i=e.onCloseConversation)||void 0===i?void 0:i.call(e,{subEntityId:t,conversationId:n,channelId:r,entityId:o})})),n(r)}))},e.closeConversation=function(){if(Ue(Ce,D.content),!t())throw B;Yt("conversations.closeConversation"),Tt("startConversation"),Tt("closeConversation")},e.getChatMembers=function(){return new Promise((function(e){if(Ue(Ce),!t())throw B;e(zt("getChatMembers"))}))},e.isSupported=t}(wn||(wn={}));var Mn,Hn="users";function Dn(e,t,n){if(0===e.length)throw new Error("Must have at least one user when creating a chat deep link");var r="".concat(Hn,"=")+e.map((function(e){return encodeURIComponent(e)})).join(","),o=void 0===t?"":"&".concat("topicName","=").concat(encodeURIComponent(t)),i=void 0===n?"":"&".concat("message","=").concat(encodeURIComponent(n));return"".concat(g,"://").concat(m).concat("/l/chat/0/0","?").concat(r).concat(o).concat(i)}function Ln(e,t,n){if(0===e.length)throw new Error("Must have at least one target when creating a call deep link");var r="".concat(Hn,"=")+e.map((function(e){return encodeURIComponent(e)})).join(","),o=void 0===t?"":"&".concat("withVideo","=").concat(encodeURIComponent(t)),i=void 0===n?"":"&".concat("source","=").concat(encodeURIComponent(n));return"".concat(g,"://").concat(m).concat("/l/call/0/0","?").concat(r).concat(o).concat(i)}function Nn(e,t,n,r,o){var i=void 0===e?"":"".concat("attendees","=")+e.map((function(e){return encodeURIComponent(e)})).join(","),a=void 0===t?"":"&".concat("startTime","=").concat(encodeURIComponent(t)),s=void 0===n?"":"&".concat("endTime","=").concat(encodeURIComponent(n)),c=void 0===r?"":"&".concat("subject","=").concat(encodeURIComponent(r)),u=void 0===o?"":"&".concat("content","=").concat(encodeURIComponent(o));return"".concat(g,"://").concat(m).concat("/l/meeting/new","?").concat(i).concat(a).concat(s).concat(c).concat(u)}function Un(e){if(!e)throw new Error("App ID must be set when creating an app install dialog deep link");return"".concat(g,"://").concat(m).concat("/l/app/").concat(encodeURIComponent(e))}!function(e){function t(){return!(!Ue(Ce)||!Ce.supports.appInstallDialog)}e.openAppInstallDialog=function(e){return new Promise((function(n){if(Ue(Ce,D.content,D.sidePanel,D.settings,D.task,D.stage,D.meetingStage),!t())throw new Error("Not supported");Ce.isLegacyTeams?n(jt("executeDeepLink",Un(e.appId))):(Yt("appInstallDialog.openAppInstallDialog",[e]),n())}))},e.isSupported=t}(Mn||(Mn={}));var Vn,xn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Bn=e.V_1,Wn=i("media");function zn(e,t){if(null==e||null==t||e.length<=0)return null;var n=null,r=1;return e.sort((function(e,t){return e.sequence>t.sequence?1:-1})),e.forEach((function(e){e.sequence==r&&(n=n?new Blob([n,e.file],{type:t}):new Blob([e.file],{type:t}),r++)})),n}function Gn(e,t){if(null==e||null==t)return null;for(var n=atob(e.chunk),r=new Array(n.length),o=0;o<n.length;o++)r[o]=n.charCodeAt(o);var i=new Uint8Array(r),a=new Blob([i],{type:t});return{sequence:e.chunkSequence,file:a}}function jn(e){Zn(e)?Be("2.0.2"):Xn(e)?Be(u):Kn(e)&&Be("2.0.4")}function qn(e){return!(e.mediaType!=Vn.MediaType.Video||!e.videoProps||!e.videoProps.videoController)}function Jn(e){return!(null==e||e.maxMediaCount>10)}function Kn(e){var t;return!((null==e?void 0:e.mediaType)!=Vn.MediaType.Image||!(null===(t=null==e?void 0:e.imageProps)||void 0===t?void 0:t.imageOutputFormats))}function Zn(e){return!(!e||e.mediaType!=Vn.MediaType.VideoAndImage&&!e.videoAndImageProps)}function Xn(e){return!(!e||e.mediaType!=Vn.MediaType.Video||!e.videoProps||e.videoProps.isFullScreenMode)}function $n(e,t,n){return null!=e&&null!=t&&t==Vn.FileFormat.ID&&null!=n}function Qn(e){return!(null==e||e.length<=0||e.length>10)}function Yn(e){return!e||!(null===e.timeOutIntervalInSec||null!=e.timeOutIntervalInSec&&e.timeOutIntervalInSec<=0||null!=e.timeOutIntervalInSec&&e.timeOutIntervalInSec>60)}function er(e){if(e){if(e.title&&"string"!=typeof e.title)return!1;if(e.setSelected&&"object"!=typeof e.setSelected)return!1;if(e.openOrgWideSearchInChatOrChannel&&"boolean"!=typeof e.openOrgWideSearchInChatOrChannel)return!1;if(e.singleSelect&&"boolean"!=typeof e.singleSelect)return!1}return!0}!function(e){!function(e){e.Base64="base64",e.ID="id"}(e.FileFormat||(e.FileFormat={}));var n=function(){return function(){}}();function r(){return!(!Ue(Ce)||!Ce.supports.permissions)}e.File=n,e.captureImage=function(e){if(!e)throw new Error("[captureImage] Callback cannot be null");Ue(Ce,D.content,D.task),C.isFramelessWindow?Ve("1.7.0")?Qt(a(Bn,t.Media_CaptureImage),"captureImage",e):e({errorCode:k.OLD_PLATFORM},[]):e({errorCode:k.NOT_SUPPORTED_ON_PLATFORM},[])},e.hasPermission=function(){if(Ue(Ce,D.content,D.task),!r())throw B;var e=R.Media;return new Promise((function(n){n(Jt(a(Bn,t.Media_HasPermission),"permissions.has",e))}))},e.requestPermission=function(){if(Ue(Ce,D.content,D.task),!r())throw B;var e=R.Media;return new Promise((function(n){n(Jt(a(Bn,t.Media_RequestPermission),"permissions.request",e))}))};var o=function(e){function n(t){var n=e.call(this)||this;return t&&(n.content=t.content,n.format=t.format,n.mimeType=t.mimeType,n.name=t.name,n.preview=t.preview,n.size=t.size),n}return xn(n,e),n.prototype.getMedia=function(e){if(!e)throw new Error("[get Media] Callback cannot be null");(Ue(Ce,D.content,D.task),Ve(d))?$n(this.mimeType,this.format,this.content)?Ve("2.0.0")?this.getMediaViaCallback(e):this.getMediaViaHandler(e):e({errorCode:k.INVALID_ARGUMENTS},new Blob):e({errorCode:k.OLD_PLATFORM},new Blob)},n.prototype.getMediaViaCallback=function(e){var n={mediaMimeType:this.mimeType,assembleAttachment:[]},r=[this.content];Qt(a(Bn,t.Media_GetMedia),"getMedia",r,(function(t){if(e)if(t&&t.error)e(t.error,new Blob);else if(t&&t.mediaChunk)if(t.mediaChunk.chunkSequence<=0){var r=zn(n.assembleAttachment,n.mediaMimeType);e(t.error,null!=r?r:new Blob)}else{var o=Gn(t.mediaChunk,n.mediaMimeType);o?n.assembleAttachment.push(o):Wn("Received a null assemble attachment for when decoding chunk sequence ".concat(t.mediaChunk.chunkSequence,"; not including the chunk in the assembled file."))}else e({errorCode:k.INTERNAL_ERROR,message:"data received is null"},new Blob)}))},n.prototype.getMediaViaHandler=function(e){var n=Q(),r={mediaMimeType:this.mimeType,assembleAttachment:[]},o=[n,this.content];this.content&&!ze(e)&&Qt(a(Bn,t.Media_GetMedia),"getMedia",o),It("getMedia"+n,(function(t){if(e){var o=JSON.parse(t);if(o.error)e(o.error,new Blob),Tt("getMedia"+n);else if(o.mediaChunk)if(o.mediaChunk.chunkSequence<=0){var i=zn(r.assembleAttachment,r.mediaMimeType);e(o.error,null!=i?i:new Blob),Tt("getMedia"+n)}else{var a=Gn(o.mediaChunk,r.mediaMimeType);a&&r.assembleAttachment.push(a)}else e({errorCode:k.INTERNAL_ERROR,message:"data received is null"},new Blob),Tt("getMedia"+n)}}))},n}(n);e.Media=o;var i,s,c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return xn(t,e),t.prototype.getMediaType=function(){return s.Video},t.prototype.notifyEventToApp=function(e){if(this.controllerCallback)switch(e){case i.StartRecording:if(this.controllerCallback.onRecordingStarted){this.controllerCallback.onRecordingStarted();break}}},t}(function(){function e(e){this.controllerCallback=e}return e.prototype.notifyEventToHost=function(e,n){Ue(Ce,D.content,D.task);try{Be(u)}catch(e){return void(n&&n(e))}var r={mediaType:this.getMediaType(),mediaControllerEvent:e};Qt(a(Bn,t.Media_Controller),"media.controller",[r],(function(e){n&&n(e)}))},e.prototype.stop=function(e){this.notifyEventToHost(i.StopRecording,e)},e}());e.VideoController=c,function(e){e[e.StartRecording=1]="StartRecording",e[e.StopRecording=2]="StopRecording"}(i=e.MediaControllerEvent||(e.MediaControllerEvent={})),function(e){e[e.Photo=1]="Photo",e[e.Document=2]="Document",e[e.Whiteboard=3]="Whiteboard",e[e.BusinessCard=4]="BusinessCard"}(e.CameraStartMode||(e.CameraStartMode={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(e.Source||(e.Source={})),function(e){e[e.Image=1]="Image",e[e.Video=2]="Video",e[e.VideoAndImage=3]="VideoAndImage",e[e.Audio=4]="Audio"}(s=e.MediaType||(e.MediaType={})),function(e){e[e.ID=1]="ID",e[e.URL=2]="URL"}(e.ImageUriType||(e.ImageUriType={})),function(e){e[e.IMAGE=1]="IMAGE",e[e.PDF=2]="PDF"}(e.ImageOutputFormats||(e.ImageOutputFormats={})),e.selectMedia=function(e,n){if(!n)throw new Error("[select Media] Callback cannot be null");if(Ue(Ce,D.content,D.task),Ve(d)){try{jn(e)}catch(e){return void n(e,[])}if(Jn(e)){var r=[e];Qt(a(Bn,t.Media_SelectMedia),"selectMedia",r,(function(t,r,i){var a,s;if(i)qn(e)&&(null===(s=null===(a=null==e?void 0:e.videoProps)||void 0===a?void 0:a.videoController)||void 0===s||s.notifyEventToApp(i));else if(r){for(var c=[],u=0,l=r;u<l.length;u++){var d=l[u];c.push(new o(d))}n(t,c)}else n(t,[])}))}else{var i={errorCode:k.INVALID_ARGUMENTS};n(i,[])}}else{var s={errorCode:k.OLD_PLATFORM};n(s,[])}},e.viewImages=function(e,n){if(!n)throw new Error("[view images] Callback cannot be null");if(Ue(Ce,D.content,D.task),Ve(d))if(Qn(e)){var r=[e];Qt(a(Bn,t.Media_ViewImages),"viewImages",r,n)}else{n({errorCode:k.INVALID_ARGUMENTS})}else n({errorCode:k.OLD_PLATFORM})},e.scanBarCode=function(e,n){if(!e)throw new Error("[media.scanBarCode] Callback cannot be null");Ue(Ce,D.content,D.task),C.hostClientType!==M.desktop&&C.hostClientType!==M.web&&C.hostClientType!==M.rigel&&C.hostClientType!==M.teamsRoomsWindows&&C.hostClientType!==M.teamsRoomsAndroid&&C.hostClientType!==M.teamsPhones&&C.hostClientType!==M.teamsDisplays?Ve("1.9.0")?Yn(n)?Qt(a(Bn,t.Media_ScanBarCode),"media.scanBarCode",[n],e):e({errorCode:k.INVALID_ARGUMENTS},""):e({errorCode:k.OLD_PLATFORM},""):e({errorCode:k.NOT_SUPPORTED_ON_PLATFORM},"")}}(Vn||(Vn={}));var tr,nr,rr=e.V_2;!function(e){function n(){return!!(Ue(Ce)&&Ce.supports.barCode&&Ce.supports.permissions)}e.scanBarCode=function(e){return new Promise((function(r){if(Ue(Ce,D.content,D.task),!n())throw B;if(!Yn(e))throw{errorCode:k.INVALID_ARGUMENTS};r(Jt(a(rr,t.BarCode_ScanBarCode),"media.scanBarCode",e))}))},e.hasPermission=function(){if(Ue(Ce,D.content,D.task),!n())throw B;var e=R.Media;return new Promise((function(n){n(Jt(a(rr,t.BarCode_HasPermission),"permissions.has",e))}))},e.requestPermission=function(){if(Ue(Ce,D.content,D.task),!n())throw B;var e=R.Media;return new Promise((function(n){n(Jt(a(rr,t.BarCode_RequestPermission),"permissions.request",e))}))},e.isSupported=n}(tr||(tr={})),function(e){function t(e){return new Promise((function(t){if(Ue(Ce,D.content,D.task),!n())throw B;Ce.isLegacyTeams?t(jt("executeDeepLink",Dn([e.user],void 0,e.message))):t(jt("chat.openChat",{members:[e.user],message:e.message}))}))}function n(){return!(!Ue(Ce)||!Ce.supports.chat)}e.openChat=t,e.openGroupChat=function(e){return new Promise((function(r){if(e.users.length<1)throw Error("OpenGroupChat Failed: No users specified");if(1===e.users.length){r(t({user:e.users[0],message:e.message}))}else{if(Ue(Ce,D.content,D.task),!n())throw B;if(Ce.isLegacyTeams)r(jt("executeDeepLink",Dn(e.users,e.topic,e.message)));else r(jt("chat.openChat",{members:e.users,message:e.message,topic:e.topic}))}}))},e.isSupported=n}(nr||(nr={}));var or,ir=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))},ar=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},sr=e.V_2;!function(e){function n(){return!!(Ue(Ce)&&navigator&&navigator.clipboard&&Ce.supports.clipboard)}e.write=function(e){return ir(this,void 0,void 0,(function(){var r,o;return ar(this,(function(i){switch(i.label){case 0:if(Ue(Ce,D.content,D.meetingStage,D.task,D.settings,D.stage,D.sidePanel),!n())throw B;if(!e.type||!Object.values(O).includes(e.type))throw new Error("Blob type ".concat(e.type," is not supported. Supported blob types are ").concat(Object.values(O)));return[4,ce(e)];case 1:return r=i.sent(),o={mimeType:e.type,content:r},[2,Jt(a(sr,t.Clipboard_Write),"clipboard.writeToClipboard",o)]}}))}))},e.read=function(){return ir(this,void 0,void 0,(function(){var e,r,o;return ar(this,(function(i){switch(i.label){case 0:if(Ue(Ce,D.content,D.meetingStage,D.task,D.settings,D.stage,D.sidePanel),!n())throw B;return xe()||C.hostClientType===M.macos?(o=(r=JSON).parse,[4,Kt("clipboard.readFromClipboard")]):[3,2];case 1:return[2,se((e=o.apply(r,[i.sent()])).mimeType,e.content)];case 2:return[2,Jt(a(sr,t.Clipboard_Read),"clipboard.readFromClipboard")]}}))}))},e.isSupported=n}(or||(or={}));var cr,ur=e.V_2;function lr(){return Ce.hostVersionsInfo?Ce.hostVersionsInfo.adaptiveCardSchemaVersion:void 0}!function(e){function n(){return!!(Ue(Ce)&&Ce.supports.geoLocation&&Ce.supports.permissions)}e.getCurrentLocation=function(){if(Ue(Ce,D.content,D.task),!n())throw B;return Jt(a(ur,t.GeoLocation_GetCurrentLocation),"location.getLocation",{allowChooseLocation:!1,showMap:!1})},e.hasPermission=function(){if(Ue(Ce,D.content,D.task),!n())throw B;var e=R.GeoLocation;return new Promise((function(n){n(Jt(a(ur,t.GeoLocation_HasPermission),"permissions.has",e))}))},e.requestPermission=function(){if(Ue(Ce,D.content,D.task),!n())throw B;var e=R.GeoLocation;return new Promise((function(n){n(Jt(a(ur,t.GeoLocation_RequestPermission),"permissions.request",e))}))},e.isSupported=n,function(e){function n(){return!!(Ue(Ce)&&Ce.supports.geoLocation&&Ce.supports.geoLocation.map&&Ce.supports.permissions)}e.chooseLocation=function(){if(Ue(Ce,D.content,D.task),!n())throw B;return Jt(a(ur,t.GeoLocation_Map_ChooseLocation),"location.getLocation",{allowChooseLocation:!0,showMap:!0})},e.showLocation=function(e){if(Ue(Ce,D.content,D.task),!n())throw B;if(!e)throw{errorCode:k.INVALID_ARGUMENTS};return Jt(a(ur,t.GeoLocation_ShowLocation),"location.showLocation",e)},e.isSupported=n}(e.map||(e.map={}))}(cr||(cr={}));var dr,fr=function(){function e(){}return e.prototype.postMessage=function(e,t){Ue(Ce),Yt("messageForChild",[e],t||X())},e.prototype.addEventListener=function(e,t){Ue(Ce),"message"===e&&It("messageForParent",t)},e}(),pr=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!1,configurable:!0}),e.prototype.postMessage=function(e,t){Ue(Ce,D.task),Yt("messageForParent",[e],t||X())},e.prototype.addEventListener=function(e,t){Ue(Ce,D.task),"message"===e&&It("messageForChild",t)},e}();!function(e){function t(){return!(!Ue(Ce)||!Ce.supports.secondaryBrowser)}e.open=function(e){if(Ue(Ce,D.content),!t())throw B;if(!e||!ae(e))throw{errorCode:k.INVALID_ARGUMENTS,message:"Invalid Url: Only https URL is allowed"};return Kt("secondaryBrowser.open",e.toString())},e.isSupported=t}(dr||(dr={}));var gr,mr=e.V_1;!function(e){function n(){return!(!Ue(Ce)||!Ce.supports.location)}e.getLocation=function(e,r){if(!r)throw new Error("[location.getLocation] Callback cannot be null");if(Ue(Ce,D.content,D.task),!Ve(l))throw{errorCode:k.OLD_PLATFORM};if(!e)throw{errorCode:k.INVALID_ARGUMENTS};if(!n())throw B;Qt(a(mr,t.Location_GetLocation),"location.getLocation",[e],r)},e.showLocation=function(e,r){if(!r)throw new Error("[location.showLocation] Callback cannot be null");if(Ue(Ce,D.content,D.task),!Ve(l))throw{errorCode:k.OLD_PLATFORM};if(!e)throw{errorCode:k.INVALID_ARGUMENTS};if(!n())throw B;Qt(a(mr,t.Location_ShowLocation),"location.showLocation",[e],r)},e.isSupported=n}(gr||(gr={}));var hr,vr,wr=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Cr=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};!function(e){var t;function n(e,n){var r=this;Yt("meeting.requestAppAudioHandling",[e.isAppHandlingAudio],(function(i,a){if(i&&null!=a)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(i)throw new Error("[requestAppAudioHandling] Callback response - SDK error ".concat(i.errorCode," ").concat(i.message));if("boolean"!=typeof a)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");It("meeting.micStateChanged",(function(n){return wr(r,void 0,void 0,(function(){var r,i;return Cr(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,e.micMuteStateChangedCallback(n)];case 1:return r=a.sent(),i=r.isMicMuted===n.isMicMuted,o(r,i?t.HostInitiated:t.AppDeclinedToChange),[3,3];case 2:return a.sent(),o(n,t.AppFailedToChange),[3,3];case 3:return[2]}}))}))}));It("meeting.audioDeviceSelectionChanged",(function(t){var n;null===(n=e.audioDeviceSelectionChangedCallback)||void 0===n||n.call(e,t)})),n(a)}))}function r(e,t){Yt("meeting.requestAppAudioHandling",[e.isAppHandlingAudio],(function(e,n){if(e&&null!=n)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(e)throw new Error("[requestAppAudioHandling] Callback response - SDK error ".concat(e.errorCode," ").concat(e.message));if("boolean"!=typeof n)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");Et("meeting.micStateChanged")&&Tt("meeting.micStateChanged"),Et("meeting.audioDeviceSelectionChanged")&&Tt("meeting.audioDeviceSelectionChanged"),t(n)}))}function o(e,t){Ue(Ce,D.sidePanel,D.meetingStage),Yt("meeting.updateMicState",[e,t])}!function(e){e[e.HostInitiated=0]="HostInitiated",e[e.AppInitiated=1]="AppInitiated",e[e.AppDeclinedToChange=2]="AppDeclinedToChange",e[e.AppFailedToChange=3]="AppFailedToChange"}(t||(t={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.applause="applause"}(e.MeetingReactionType||(e.MeetingReactionType={})),function(e){e.Unknown="Unknown",e.Adhoc="Adhoc",e.Scheduled="Scheduled",e.Recurring="Recurring",e.Broadcast="Broadcast",e.MeetNow="MeetNow"}(e.MeetingType||(e.MeetingType={})),function(e){e.OneOnOneCall="oneOnOneCall",e.GroupCall="groupCall"}(e.CallType||(e.CallType={})),e.getIncomingClientAudioState=function(e){if(!e)throw new Error("[get incoming client audio state] Callback cannot be null");Ue(Ce,D.sidePanel,D.meetingStage),Yt("getIncomingClientAudioState",e)},e.toggleIncomingClientAudio=function(e){if(!e)throw new Error("[toggle incoming client audio] Callback cannot be null");Ue(Ce,D.sidePanel,D.meetingStage),Yt("toggleIncomingClientAudio",e)},e.getMeetingDetails=function(e){if(!e)throw new Error("[get meeting details] Callback cannot be null");Ue(Ce,D.sidePanel,D.meetingStage,D.settings,D.content),Yt("meeting.getMeetingDetails",e)},e.getAuthenticationTokenForAnonymousUser=function(e){if(!e)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");Ue(Ce,D.sidePanel,D.meetingStage,D.task),Yt("meeting.getAuthenticationTokenForAnonymousUser",e)},e.getLiveStreamState=function(e){if(!e)throw new Error("[get live stream state] Callback cannot be null");Ue(Ce,D.sidePanel),Yt("meeting.getLiveStreamState",e)},e.requestStartLiveStreaming=function(e,t,n){if(!e)throw new Error("[request start live streaming] Callback cannot be null");Ue(Ce,D.sidePanel),Yt("meeting.requestStartLiveStreaming",[t,n],e)},e.requestStopLiveStreaming=function(e){if(!e)throw new Error("[request stop live streaming] Callback cannot be null");Ue(Ce,D.sidePanel),Yt("meeting.requestStopLiveStreaming",e)},e.registerLiveStreamChangedHandler=function(e){if(!e)throw new Error("[register live stream changed handler] Handler cannot be null");Ue(Ce,D.sidePanel),It("meeting.liveStreamChanged",e)},e.shareAppContentToStage=function(e,t){if(!e)throw new Error("[share app content to stage] Callback cannot be null");Ue(Ce,D.sidePanel,D.meetingStage),Yt("meeting.shareAppContentToStage",[t],e)},e.getAppContentStageSharingCapabilities=function(e){if(!e)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");Ue(Ce,D.sidePanel,D.meetingStage),Yt("meeting.getAppContentStageSharingCapabilities",e)},e.stopSharingAppContentToStage=function(e){if(!e)throw new Error("[stop sharing app content to stage] Callback cannot be null");Ue(Ce,D.sidePanel,D.meetingStage),Yt("meeting.stopSharingAppContentToStage",e)},e.getAppContentStageSharingState=function(e){if(!e)throw new Error("[get app content stage sharing state] Callback cannot be null");Ue(Ce,D.sidePanel,D.meetingStage),Yt("meeting.getAppContentStageSharingState",e)},e.registerSpeakingStateChangeHandler=function(e){if(!e)throw new Error("[registerSpeakingStateChangeHandler] Handler cannot be null");Ue(Ce,D.sidePanel,D.meetingStage),It("meeting.speakingStateChanged",e)},e.registerRaiseHandStateChangedHandler=function(e){if(!e)throw new Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");Ue(Ce,D.sidePanel,D.meetingStage),It("meeting.raiseHandStateChanged",e)},e.registerMeetingReactionReceivedHandler=function(e){if(!e)throw new Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");Ue(Ce,D.sidePanel,D.meetingStage),It("meeting.meetingReactionReceived",e)},function(e){e.setOptions=function(e){Ue(Ce,D.sidePanel),e.contentUrl&&new URL(e.contentUrl),Yt("meeting.appShareButton.setOptions",[e])}}(e.appShareButton||(e.appShareButton={})),e.requestAppAudioHandling=function(e,t){if(!t)throw new Error("[requestAppAudioHandling] Callback response cannot be null");if(!e.micMuteStateChangedCallback)throw new Error("[requestAppAudioHandling] Callback Mic mute state handler cannot be null");Ue(Ce,D.sidePanel,D.meetingStage),e.isAppHandlingAudio?n(e,t):r(e,t)},e.updateMicState=function(e){o(e,t.AppInitiated)}}(hr||(hr={})),function(e){function t(){return!(!Ue(Ce)||!Ce.supports.monetization)}e.openPurchaseExperience=function(e,n){var r,o;return"function"==typeof e?(r=e,o=n):o=e,Ue(Ce,D.content),ne((function(){return new Promise((function(e){if(!t())throw B;e(Kt("monetization.openPurchaseExperience",o))}))}),r)},e.isSupported=t}(vr||(vr={}));var br,yr=e.V_2;!function(e){function n(){return!(!Ue(Ce)||!Ce.supports.calendar)}e.openCalendarItem=function(e){return new Promise((function(r){if(Ue(Ce,D.content),!n())throw new Error("Not supported");if(!e.itemId||!e.itemId.trim())throw new Error("Must supply an itemId to openCalendarItem");r(Gt(a(yr,t.Calendar_OpenCalendarItem),"calendar.openCalendarItem",e))}))},e.composeMeeting=function(e){return new Promise((function(r){if(Ue(Ce,D.content),!n())throw new Error("Not supported");Ce.isLegacyTeams?r(jt("executeDeepLink",Nn(e.attendees,e.startTime,e.endTime,e.subject,e.content))):r(Gt(a(yr,t.Calendar_ComposeMeeting),"calendar.composeMeeting",e))}))},e.isSupported=n}(br||(br={}));var Sr,Pr,Ir,Tr,Er=e.V_2;function Fr(e){return e?e.modality&&"string"!=typeof e.modality?[!1,"modality must be a string"]:e.targetElementBoundingRect&&"object"==typeof e.targetElementBoundingRect?e.triggerType&&"string"==typeof e.triggerType?_r(e.persona):[!1,"triggerType must be a valid string"]:[!1,"targetElementBoundingRect must be a DOMRect"]:[!1,"A request object is required"]}function _r(e){return e?e.displayName&&"string"!=typeof e.displayName?[!1,"displayName must be a string"]:e.identifiers&&"object"==typeof e.identifiers?e.identifiers.AadObjectId||e.identifiers.Smtp||e.identifiers.Upn?e.identifiers.AadObjectId&&"string"!=typeof e.identifiers.AadObjectId?[!1,"AadObjectId identifier must be a string"]:e.identifiers.Smtp&&"string"!=typeof e.identifiers.Smtp?[!1,"Smtp identifier must be a string"]:e.identifiers.Upn&&"string"!=typeof e.identifiers.Upn?[!1,"Upn identifier must be a string"]:[!0,void 0]:[!1,"at least one valid identifier must be provided"]:[!1,"persona identifiers object must be provided"]:[!1,"persona object must be provided"]}!function(e){function n(){return!(!Ue(Ce)||!Ce.supports.mail)}e.openMailItem=function(e){return new Promise((function(r){if(Ue(Ce,D.content),!n())throw new Error("Not supported");if(!e.itemId||!e.itemId.trim())throw new Error("Must supply an itemId to openMailItem");r(Gt(a(Er,t.Mail_OpenMailItem),"mail.openMailItem",e))}))},e.composeMail=function(e){return new Promise((function(r){if(Ue(Ce,D.content),!n())throw new Error("Not supported");r(Gt(a(Er,t.Mail_ComposeMail),"mail.composeMail",e))}))},e.isSupported=n,function(e){e.New="new",e.Reply="reply",e.ReplyAll="replyAll",e.Forward="forward"}(e.ComposeMailType||(e.ComposeMailType={}))}(Sr||(Sr={})),function(e){function t(){ue().print()}function n(e,t){!ze(e)&&Ue(Ce),!ze(e)&&t&&t(),kt(e)}function r(e,t){!ze(e)&&Ue(Ce),!ze(e)&&t&&t(),Ot(e)}function o(){return!(!Ue(Ce)||!Ce.supports.teamsCore)}e.enablePrintCapability=function(){if(!C.printCapabilityEnabled){if(Ue(Ce),!o())throw B;C.printCapabilityEnabled=!0,document.addEventListener("keydown",(function(e){(e.ctrlKey||e.metaKey)&&80===e.keyCode&&(t(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())}))}},e.print=t,e.registerOnLoadHandler=function(e){n(e,(function(){if(!ze(e)&&!o())throw B}))},e.registerOnLoadHandlerHelper=n,e.registerBeforeUnloadHandler=function(e){r(e,(function(){if(!ze(e)&&!o())throw B}))},e.registerBeforeUnloadHandlerHelper=r,e.isSupported=o}(Pr||(Pr={})),function(e){function t(e){return new Promise((function(t){if(!Ve("2.0.0"))throw{errorCode:k.OLD_PLATFORM};if(!er(e))throw{errorCode:k.INVALID_ARGUMENTS};if(!n())throw B;t(Kt("people.selectPeople",e))}))}function n(){return!(!Ue(Ce)||!Ce.supports.people)}e.selectPeople=function(e,n){var r;Ue(Ce,D.content,D.task,D.settings);var o=void 0,i=void 0;return"function"==typeof e?(o=(r=[e,n])[0],i=r[1]):i=e,ee(t,o,i)},e.isSupported=n}(Ir||(Ir={})),function(e){e.showProfile=function(e){return Ue(Ce,D.content),new Promise((function(t){var n=Fr(e),r=n[0],o=n[1];if(!r)throw{errorCode:k.INVALID_ARGUMENTS,message:o};t(Kt("profile.showProfile",{modality:e.modality,persona:e.persona,triggerType:e.triggerType,targetRectangle:{x:e.targetElementBoundingRect.x,y:e.targetElementBoundingRect.y,width:e.targetElementBoundingRect.width,height:e.targetElementBoundingRect.height}}))}))},e.isSupported=function(){return!(!Ue(Ce)||!Ce.supports.profile)}}(Tr||(Tr={}));var Ar,kr=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Rr=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};function Or(e,t,n,r){var o,i;return kr(this,void 0,void 0,(function(){var a,s;return Rr(this,(function(c){switch(c.label){case 0:return a=Dr(),!le()&&(null===(i=null===(o=window.chrome)||void 0===o?void 0:o.webview)||void 0===i||i.registerTextureStream(e,a)),s=Lr,[4,Hr(e,n,r)];case 1:return s.apply(void 0,[c.sent(),new Nr(n,t),a.writable]),[2]}}))}))}function Mr(e,t,n,r){var o,i;return kr(this,void 0,void 0,(function(){var a,s;return Rr(this,(function(c){switch(c.label){case 0:return a=Dr(),!le()&&(null===(i=null===(o=window.chrome)||void 0===o?void 0:o.webview)||void 0===i||i.registerTextureStream(e,a)),s=Lr,[4,Hr(e,n,r)];case 1:return s.apply(void 0,[c.sent(),new xr(n,t),a.writable]),[2]}}))}))}function Hr(e,t,n){return kr(this,void 0,void 0,(function(){var r,o,i,a,s;return Rr(this,(function(c){switch(c.label){case 0:if(le())throw B;r=ue().chrome,c.label=1;case 1:return c.trys.push([1,3,,4]),null==n||n.reportGettingTextureStream(e),[4,r.webview.getTextureStream(e)];case 2:if(o=c.sent(),0===(i=o.getVideoTracks()).length)throw new Error("No video track in stream ".concat(e));return null==n||n.reportTextureStreamAcquired(),[2,i[0]];case 3:throw a=c.sent(),s="Failed to get video track from stream ".concat(e,", error: ").concat(a),t(s),new Error("Internal error: can't get video track from stream ".concat(e));case 4:return[2]}}))}))}function Dr(){if(le())throw B;var e=window.MediaStreamTrackGenerator;if(!e)throw B;return new e({kind:"video"})}function Lr(e,t,n){new(0,ue().MediaStreamTrackProcessor)({track:e}).readable.pipeThrough(new TransformStream(t)).pipeTo(n)}!function(e){e.TimestampIsNull="timestamp of the original video frame is null",e.UnsupportedVideoFramePixelFormat="Unsupported video frame pixel format"}(Ar||(Ar={}));var Nr=function(){return function(e,t){var n=this;this.notifyError=e,this.videoFrameHandler=t,this.transform=function(e,t){return kr(n,void 0,void 0,(function(){var n,r,o,i;return Rr(this,(function(a){switch(a.label){case 0:if(null===(n=e.timestamp))return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.videoFrameHandler({videoFrame:e})];case 2:return r=a.sent(),o=new VideoFrame(r,{timestamp:n}),t.enqueue(o),e.close(),r.close(),[3,4];case 3:return i=a.sent(),e.close(),this.notifyError(i),[3,4];case 4:return[3,6];case 5:this.notifyError(Ar.TimestampIsNull),a.label=6;case 6:return[2]}}))}))}}}(),Ur=function(){function e(e,t){if(this.headerBuffer=e,this.notifyError=t,this.ONE_TEXTURE_INPUT_ID=1869900081,this.INVALID_HEADER_ERROR="Invalid video frame header",this.UNSUPPORTED_LAYOUT_ERROR="Unsupported texture layout",this.headerDataView=new Uint32Array(e),this.headerDataView.length<8)throw this.notifyError(this.INVALID_HEADER_ERROR),new Error(this.INVALID_HEADER_ERROR);if(this.headerDataView[0]!==this.ONE_TEXTURE_INPUT_ID)throw this.notifyError(this.UNSUPPORTED_LAYOUT_ERROR),new Error(this.UNSUPPORTED_LAYOUT_ERROR)}return Object.defineProperty(e.prototype,"oneTextureLayoutId",{get:function(){return this.headerDataView[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this.headerDataView[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frameRowOffset",{get:function(){return this.headerDataView[2]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frameFormat",{get:function(){return this.headerDataView[3]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frameWidth",{get:function(){return this.headerDataView[4]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frameHeight",{get:function(){return this.headerDataView[5]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"multiStreamHeaderRowOffset",{get:function(){return this.headerDataView[6]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"multiStreamCount",{get:function(){return this.headerDataView[7]},enumerable:!1,configurable:!0}),e}(),Vr=function(){function e(e,t){this.metadataMap=new Map,this.AUDIO_INFERENCE_RESULT_STREAM_ID=828664161;for(var n=new Uint32Array(e),r=0,o=0;r<t;r++){var i=n[o++],a=n[o++],s=n[o++],c=new Uint8Array(e,a,s);this.metadataMap.set(i,c)}}return Object.defineProperty(e.prototype,"audioInferenceResult",{get:function(){return this.metadataMap.get(this.AUDIO_INFERENCE_RESULT_STREAM_ID)},enumerable:!1,configurable:!0}),e}(),xr=function(){return function(e,t){var n=this;this.notifyError=e,this.videoFrameHandler=t,this.shouldDiscardAudioInferenceResult=!1,this.transform=function(e,t){return kr(n,void 0,void 0,(function(){var n,r,o,i,a,s,c,u;return Rr(this,(function(l){switch(l.label){case 0:if(null===(n=e.timestamp))return[3,6];l.label=1;case 1:return l.trys.push([1,4,,5]),[4,this.extractVideoFrameAndMetadata(e)];case 2:return r=l.sent(),o=r.videoFrame,i=r.metadata,a=(void 0===i?{}:i).audioInferenceResult,[4,this.videoFrameHandler({videoFrame:o,audioInferenceResult:a})];case 3:return s=l.sent(),c=new VideoFrame(s,{timestamp:n}),t.enqueue(c),o.close(),e.close(),s.close(),[3,5];case 4:return u=l.sent(),e.close(),this.notifyError(u),[3,5];case 5:return[3,7];case 6:this.notifyError(Ar.TimestampIsNull),l.label=7;case 7:return[2]}}))}))},this.extractVideoFrameAndMetadata=function(e){return kr(n,void 0,void 0,(function(){var t,n,r,o,i,a;return Rr(this,(function(s){switch(s.label){case 0:if(le())throw B;if("NV12"!==e.format)throw this.notifyError(Ar.UnsupportedVideoFramePixelFormat),new Error(Ar.UnsupportedVideoFramePixelFormat);return t={x:0,y:0,width:e.codedWidth,height:2},n=new ArrayBuffer(t.width*t.height*3/2),[4,e.copyTo(n,{rect:t})];case 1:return s.sent(),r=new Ur(n,this.notifyError),o={x:0,y:r.multiStreamHeaderRowOffset,width:e.codedWidth,height:e.codedHeight-r.multiStreamHeaderRowOffset},i=new ArrayBuffer(o.width*o.height*3/2),[4,e.copyTo(i,{rect:o})];case 2:return s.sent(),a=new Vr(i,r.multiStreamCount),[2,{videoFrame:new VideoFrame(e,{timestamp:e.timestamp,visibleRect:{x:0,y:r.frameRowOffset,width:r.frameWidth,height:r.frameHeight}}),metadata:{audioInferenceResult:this.shouldDiscardAudioInferenceResult?void 0:a.audioInferenceResult}}]}}))}))},It("video.mediaStream.audioInferenceDiscardStatusChange",(function(e){var t=e.discardAudioInferenceResult;n.shouldDiscardAudioInferenceResult=t}))}}();function Br(e,t){return function(n,r){null==t||t.reportApplyingVideoEffect(n||"",r),e(n,r).then((function(){null==t||t.reportVideoEffectChanged(n||"",r),Yt("video.videoEffectReadiness",[!0,n,void 0,r])})).catch((function(e){var t=e in Wr.EffectFailureReason?e:Wr.EffectFailureReason.InitializationFailure;Yt("video.videoEffectReadiness",[!1,n,t,r])}))}}var Wr,zr,Gr,jr,qr=function(){function e(){}return e.setTimeout=function(t,n){var r=performance.now(),o=Q();return e.setTimeoutCallbacks[o]={callback:t,timeoutInMs:n,startedAtInMs:r},o},e.clearTimeout=function(t){delete e.setTimeoutCallbacks[t]},e.setInterval=function(t,n){e.setTimeout((function r(){t(),e.setTimeout(r,n)}),n)},e.tick=function(){var t=performance.now(),n=[];for(var r in e.setTimeoutCallbacks){t-(a=e.setTimeoutCallbacks[r]).startedAtInMs>=a.timeoutInMs&&n.push(r)}for(var o=0,i=n;o<i.length;o++){var a,s=i[o];(a=e.setTimeoutCallbacks[s]).callback(),delete e.setTimeoutCallbacks[s]}},e.setTimeoutCallbacks={},e}(),Jr=function(){function e(e,t){this.reportStatisticsResult=t,this.sampleCount=0,this.distributionBins=new Uint32Array(e)}return e.prototype.processStarts=function(e,t,n,r){qr.tick(),this.suitableForThisSession(e,t,n,r)||this.reportAndResetSession(this.getStatistics(),e,r,t,n),this.start()},e.prototype.processEnds=function(){var e=performance.now()-this.frameProcessingStartedAt,t=Math.floor(Math.max(0,Math.min(this.distributionBins.length-1,e)));this.distributionBins[t]+=1,this.sampleCount+=1},e.prototype.getStatistics=function(){return this.currentSession?{effectId:this.currentSession.effectId,effectParam:this.currentSession.effectParam,frameHeight:this.currentSession.frameHeight,frameWidth:this.currentSession.frameWidth,duration:performance.now()-this.currentSession.startedAtInMs,sampleCount:this.sampleCount,distributionBins:this.distributionBins.slice()}:null},e.prototype.start=function(){this.frameProcessingStartedAt=performance.now()},e.prototype.suitableForThisSession=function(e,t,n,r){return this.currentSession&&this.currentSession.effectId===e&&this.currentSession.effectParam===r&&this.currentSession.frameWidth===t&&this.currentSession.frameHeight===n},e.prototype.reportAndResetSession=function(e,t,n,r,o){var i=this;e&&this.reportStatisticsResult(e),this.resetCurrentSession(this.getNextTimeout(t,this.currentSession),t,n,r,o),this.timeoutId&&qr.clearTimeout(this.timeoutId),this.timeoutId=qr.setTimeout(function(){return i.reportAndResetSession(i.getStatistics(),t,n,r,o)}.bind(this),this.currentSession.timeoutInMs)},e.prototype.resetCurrentSession=function(e,t,n,r,o){this.currentSession={startedAtInMs:performance.now(),timeoutInMs:e,effectId:t,effectParam:n,frameWidth:r,frameHeight:o},this.sampleCount=0,this.distributionBins.fill(0)},e.prototype.getNextTimeout=function(t,n){return n&&n.effectId===t?Math.min(e.maxSessionTimeoutInMs,2*n.timeoutInMs):e.initialSessionTimeoutInMs},e.initialSessionTimeoutInMs=1e3,e.maxSessionTimeoutInMs=3e4,e}(),Kr=function(){function e(t){var n=this;this.reportPerformanceEvent=t,this.isFirstFrameProcessed=!1,this.frameProcessTimeLimit=100,this.frameProcessingStartedAt=0,this.frameProcessingTimeCost=0,this.processedFrameCount=0,this.performanceStatistics=new Jr(e.distributionBinSize,(function(e){return n.reportPerformanceEvent("video.performance.performanceDataGenerated",[e])}))}return e.prototype.startMonitorSlowFrameProcessing=function(){var t=this;qr.setInterval((function(){if(0!==t.processedFrameCount){var e=t.frameProcessingTimeCost/t.processedFrameCount;e>t.frameProcessTimeLimit&&t.reportPerformanceEvent("video.performance.frameProcessingSlow",[e]),t.frameProcessingTimeCost=0,t.processedFrameCount=0}}),e.calculateFPSInterval)},e.prototype.setFrameProcessTimeLimit=function(e){this.frameProcessTimeLimit=e},e.prototype.reportApplyingVideoEffect=function(e,t){var n,r;(null===(n=this.applyingEffect)||void 0===n?void 0:n.effectId)===e&&(null===(r=this.applyingEffect)||void 0===r?void 0:r.effectParam)===t||(this.applyingEffect={effectId:e,effectParam:t},this.appliedEffect=void 0)},e.prototype.reportVideoEffectChanged=function(e,t){void 0===this.applyingEffect||this.applyingEffect.effectId!==e&&this.applyingEffect.effectParam!==t||(this.appliedEffect={effectId:e,effectParam:t},this.applyingEffect=void 0,this.isFirstFrameProcessed=!1)},e.prototype.reportStartFrameProcessing=function(e,t){qr.tick(),this.appliedEffect&&(this.frameProcessingStartedAt=performance.now(),this.performanceStatistics.processStarts(this.appliedEffect.effectId,e,t,this.appliedEffect.effectParam))},e.prototype.reportFrameProcessed=function(){var e;this.appliedEffect&&(this.processedFrameCount++,this.frameProcessingTimeCost+=performance.now()-this.frameProcessingStartedAt,this.performanceStatistics.processEnds(),this.isFirstFrameProcessed||(this.isFirstFrameProcessed=!0,this.reportPerformanceEvent("video.performance.firstFrameProcessed",[Date.now(),this.appliedEffect.effectId,null===(e=this.appliedEffect)||void 0===e?void 0:e.effectParam])))},e.prototype.reportGettingTextureStream=function(e){this.gettingTextureStreamStartedAt=performance.now(),this.currentStreamId=e},e.prototype.reportTextureStreamAcquired=function(){if(void 0!==this.gettingTextureStreamStartedAt){var e=performance.now()-this.gettingTextureStreamStartedAt;this.reportPerformanceEvent("video.performance.textureStreamAcquired",[this.currentStreamId,e])}},e.distributionBinSize=1e3,e.calculateFPSInterval=1e3,e}(),Zr=function(){return Zr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Zr.apply(this,arguments)},Xr=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))},$r=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Qr=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};!function(e){var t=le()?void 0:new Kr(Yt);function n(e){Yt("video.videoFrameProcessed",[e])}function r(e){Yt("video.notifyError",[e])}function o(){return Ue(Ce)&&!!Ce.supports.video&&(!!Ce.supports.video.mediaStream||!!Ce.supports.video.sharedFrame)}function i(e,n){var i=this;if(Ue(Ce,D.sidePanel),!o()||!u())throw B;It("video.startVideoExtensibilityVideoStream",(function(n){return Xr(i,void 0,void 0,(function(){var o,i;return $r(this,(function(s){switch(s.label){case 0:return o=n.streamId,i=a(e,t),[4,Or(o,i,r,t)];case 1:return s.sent(),[2]}}))}))}),!1),Yt("video.mediaStream.registerForVideoFrame",[n])}function a(e,t){var n=this;return function(r){return Xr(n,void 0,void 0,(function(){var n,o;return $r(this,(function(i){switch(i.label){case 0:return n=r.videoFrame,null==t||t.reportStartFrameProcessing(n.codedWidth,n.codedHeight),[4,e(r)];case 1:return o=i.sent(),null==t||t.reportFrameProcessed(),[2,o]}}))}))}}function s(e,i){if(Ue(Ce,D.sidePanel),!o()||!d())throw B;It("video.newVideoFrame",(function(o){if(o){var i=o.timestamp;null==t||t.reportStartFrameProcessing(o.width,o.height),e(c(o),(function(){null==t||t.reportFrameProcessed(),n(i)}),r)}}),!1),Yt("video.registerForVideoFrame",[i])}function c(e){if("videoFrameBuffer"in e)return e;var t=e.data,n=Qr(e,["data"]);return Zr(Zr({},n),{videoFrameBuffer:t})}function u(){var e;return Ue(Ce,D.sidePanel)&&l()&&!!(null===(e=Ce.supports.video)||void 0===e?void 0:e.mediaStream)}function l(){var e,t,n,r;return!(!(null===(t=null===(e=ue().chrome)||void 0===e?void 0:e.webview)||void 0===t?void 0:t.getTextureStream)||!(null===(r=null===(n=ue().chrome)||void 0===n?void 0:n.webview)||void 0===r?void 0:r.registerTextureStream))}function d(){var e;return Ue(Ce,D.sidePanel)&&!!(null===(e=Ce.supports.video)||void 0===e?void 0:e.sharedFrame)}!function(e){e.NV12="NV12"}(e.VideoFrameFormat||(e.VideoFrameFormat={})),function(e){e.EffectChanged="EffectChanged",e.EffectDisabled="EffectDisabled"}(e.EffectChangeType||(e.EffectChangeType={})),function(e){e.InvalidEffectId="InvalidEffectId",e.InitializationFailure="InitializationFailure"}(e.EffectFailureReason||(e.EffectFailureReason={})),e.registerForVideoFrame=function(e){if(Ue(Ce,D.sidePanel),!o())throw B;if(!e.videoFrameHandler||!e.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(It("video.setFrameProcessTimeLimit",(function(e){return null==t?void 0:t.setFrameProcessTimeLimit(e.timeLimit)}),!1),u())i(e.videoFrameHandler,e.config);else{if(!d())throw B;s(e.videoBufferHandler,e.config)}null==t||t.startMonitorSlowFrameProcessing()},e.notifySelectedVideoEffectChanged=function(e,t){if(Ue(Ce,D.sidePanel),!o())throw B;Yt("video.videoEffectChanged",[e,t])},e.registerForVideoEffect=function(e){if(Ue(Ce,D.sidePanel),!o())throw B;It("video.effectParameterChange",Br(e,t),!1),Yt("video.registerForVideoEffect")},e.isSupported=o}(Wr||(Wr={})),function(e){var t="search.queryChange",n="search.queryClose",r="search.queryExecute";function o(){return!(!Ue(Ce)||!Ce.supports.search)}e.registerHandlers=function(e,i,a){if(Ue(Ce,D.content),!o())throw B;It(n,e),It(r,i),a&&It(t,a)},e.unregisterHandlers=function(){if(Ue(Ce,D.content),!o())throw B;Yt("search.unregister"),Tt(t),Tt(n),Tt(r)},e.isSupported=o,e.closeSearch=function(){return new Promise((function(e){if(Ue(Ce,D.content),!o())throw new Error("Not supported");e(jt("search.closeSearch"))}))}}(zr||(zr={})),function(e){function t(t){return new Promise((function(n){if(!i())throw B;n(Kt(e.SharingAPIMessages.shareWebContent,t))}))}function n(e){if(!(e&&e.content&&e.content.length))throw{errorCode:k.INVALID_ARGUMENTS,message:"Shared content is missing"}}function r(e){if(e.content.some((function(e){return!e.type})))throw{errorCode:k.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"};if(e.content.some((function(t){return t.type!==e.content[0].type})))throw{errorCode:k.INVALID_ARGUMENTS,message:"Shared content must be of the same type"}}function o(e){if("URL"!==e.content[0].type)throw{errorCode:k.INVALID_ARGUMENTS,message:"Content type is unsupported"};if(e.content.some((function(e){return!e.url})))throw{errorCode:k.INVALID_ARGUMENTS,message:"URLs are required for URL content types"}}function i(){return!(!Ue(Ce)||!Ce.supports.sharing)}e.SharingAPIMessages={shareWebContent:"sharing.shareWebContent"},e.shareWebContent=function(e,i){try{n(e),r(e),o(e)}catch(e){return te((function(){return Promise.reject(e)}),i)}return Ue(Ce,D.content,D.sidePanel,D.task,D.stage,D.meetingStage),te(t,i,e)},e.isSupported=i}(Gr||(Gr={})),function(e){function t(){return!(!Ue(Ce)||!Ce.supports.stageView)}!function(e){e.modal="modal",e.popout="popout",e.popoutWithChat="popoutWithChat"}(e.StageViewOpenMode||(e.StageViewOpenMode={})),e.open=function(e){return new Promise((function(n){if(Ue(Ce,D.content),!t())throw B;if(!e)throw new Error("[stageView.open] Stage view params cannot be null");n(Kt("stageView.open",e))}))},e.isSupported=t}(jr||(jr={}));var Yr,eo,to=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))},no=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};!function(e){var t;!function(e){e[e.FrontOrRear=1]="FrontOrRear",e[e.FrontOnly=2]="FrontOnly",e[e.RearOnly=3]="RearOnly"}(e.CameraRestriction||(e.CameraRestriction={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(e.Source||(e.Source={})),e.hasPermission=function(){if(Ue(Ce,D.content,D.task),!t.isSupported())throw B;return Kt("permissions.has",R.Media)},e.requestPermission=function(){if(Ue(Ce,D.content,D.task),!t.isSupported())throw B;return Kt("permissions.request",R.Media)},function(e){function t(){return!!(Ue(Ce)&&Ce.supports.visualMedia&&Ce.supports.visualMedia.image&&Ce.supports.permissions)}function n(){if(!t())throw B}function r(e){if(!e||e.maxVisualMediaCount>10||e.maxVisualMediaCount<1)throw j}function o(e,t){if(t.length>e)throw q}e.captureImages=function(e){return to(this,void 0,void 0,(function(){var t;return no(this,(function(i){switch(i.label){case 0:return Ue(Ce,D.content,D.task),n(),r(e),[4,Kt("visualMedia.image.captureImages",e)];case 1:return t=i.sent(),o(e.maxVisualMediaCount,t),[2,t]}}))}))},e.retrieveImages=function(e){return to(this,void 0,void 0,(function(){var t;return no(this,(function(i){switch(i.label){case 0:return Ue(Ce,D.content,D.task),n(),r(e),[4,Kt("visualMedia.image.retrieveImages",e)];case 1:return t=i.sent(),o(e.maxVisualMediaCount,t),[2,t]}}))}))},e.isSupported=t}(t=e.image||(e.image={}))}(Yr||(Yr={})),function(e){function t(){return!(!Ue(Ce)||!Ce.supports.webStorage)}e.isWebStorageClearedOnUserLogOut=function(){return Ue(Ce),t()},e.isSupported=t}(eo||(eo={}));var ro,oo,io=e.V_2;!function(e){var n;function r(){return!(!Ue(Ce)||!Ce.supports.call)}!function(e){e.Unknown="unknown",e.Audio="audio",e.Video="video",e.VideoBasedScreenSharing="videoBasedScreenSharing",e.Data="data"}(n=e.CallModalities||(e.CallModalities={})),e.startCall=function(e){var o=a(io,t.Call_StartCall);return new Promise((function(t){var i;if(Ue(Ce,D.content,D.task),!r())throw B;if(!Ce.isLegacyTeams)return Qt(o,"call.startCall",[e],t);t(Wt(o,"executeDeepLink",Ln(e.targets,null===(i=e.requestedModalities)||void 0===i?void 0:i.includes(n.Video),e.source)).then((function(e){if(!e)throw new Error("The call was not properly started");return e})))}))},e.isSupported=r}(ro||(ro={})),function(e){e.Messages=tt.Messages,e.FailedReason=tt.FailedReason,e.ExpectedFailureReason=tt.ExpectedFailureReason,e.notifyAppLoaded=function(){tt.notifyAppLoaded()},e.notifySuccess=function(){tt.notifySuccess()},e.notifyFailure=function(e){tt.notifyFailure(e)},e.notifyExpectedFailure=function(e){tt.notifyExpectedFailure(e)}}(oo||(oo={}));var ao=e.V_1;function so(e,n){et(a(ao,t.PublicAPIs_Initialize),n).then((function(){e&&e()}))}function co(){Pr.enablePrintCapability()}function uo(){Pr.print()}function lo(e){Ne(),Qt(a(ao,t.PublicAPIs_GetContext),"getContext",(function(t){t.frameContext||(t.frameContext=C.frameContext),e(t)}))}function fo(e){ot(a(ao,t.PublicAPIs_RegisterOnThemeChangeHandlerHelper),e)}function po(e){Ft(a(ao,t.PublicAPIs_RegisterFullScreenHandler),"fullScreenChange",e,[])}function go(e){Ft(a(ao,t.PublicAPIs_RegisterAppButtonClickHandler),"appButtonClick",e,[D.content])}function mo(e){Ft(a(ao,t.PublicAPIs_RegisterAppButtonHoverEnterHandler),"appButtonHoverEnter",e,[D.content])}function ho(e){Ft(a(ao,t.PublicAPIs_RegisterAppButtonHoverLeaveHandler),"appButtonHoverLeave",e,[D.content])}function vo(e){st.backStack.registerBackButtonHandlerHelper(a(ao,t.PublicAPIs_RegisterBackButtonHandler),e)}function wo(e){Pr.registerOnLoadHandlerHelper(e)}function Co(e){Pr.registerBeforeUnloadHandlerHelper(e)}function bo(e){Ft(a(ao,t.PublicAPIs_RegisterFocusEnterHandler),"focusEnter",e,[])}function yo(e){Ft(a(ao,t.PublicAPIs_RegisterChangeSettingsHandler),"changeSettings",e,[D.content])}function So(e,n){Ue(Ce),pt(a(ao,t.PublicAPIs_GetTabInstances),n).then((function(t){e(t)}))}function Po(e,n){Ue(Ce),gt(a(ao,t.PublicAPIs_GetMruTabInstances),n).then((function(t){e(t)}))}function Io(e){mt(a(ao,t.PublicAPIs_ShareDeepLink),{subPageId:e.subEntityId,subPageLabel:e.subEntityLabel,subPageWebUrl:e.subEntityWebUrl})}function To(e,n){Ue(Ce,D.content,D.sidePanel,D.settings,D.task,D.stage,D.meetingStage);var r=null!=n?n:X();it(a(ao,t.PublicAPIs_ExecuteDeepLink),e).then((function(){r(!0)})).catch((function(e){r(!1,e.message)}))}function Eo(e){ht(a(ao,t.PublicAPIs_SetFrameContext),e)}function Fo(e,n,r){et(a(ao,t.PublicAPIs_Initialize),r).then((function(){return n&&n()})),ht(a(ao,t.PublicAPIs_SetFrameContext),e)}var _o,Ao=e.V_1;function ko(e){ft(a(Ao,t.Navigation_ReturnFocus),e)}function Ro(e,n){Ue(Ce);var r=null!=n?n:X();dt(a(Ao,t.Navigation_NavigateToTab),e).then((function(){r(!0)})).catch((function(e){r(!1,e.message)}))}function Oo(e,n){Ue(Ce,D.content,D.sidePanel,D.settings,D.remove,D.task,D.stage,D.meetingStage);var r=null!=n?n:X();ut(a(Ao,t.Navigation_NavigateCrossDomain),e).then((function(){r(!0)})).catch((function(e){r(!1,e.message)}))}function Mo(e){Ue(Ce);var n=null!=e?e:X();lt(a(Ao,t.Navigation_NavigateBack)).then((function(){n(!0)})).catch((function(e){n(!1,e.message)}))}!function(e){e.setValidityState=function(e){st.config.setValidityState(e)},e.getSettings=function(e){Ue(Ce,D.content,D.settings,D.remove,D.sidePanel),st.getConfig().then((function(t){e(t)}))},e.setSettings=function(e,t){Ue(Ce,D.content,D.settings,D.sidePanel);var n=null!=t?t:X();st.config.setConfig(e).then((function(){n(!0)})).catch((function(e){n(!1,e.message)}))},e.registerOnSaveHandler=function(e){st.config.registerOnSaveHandlerHelper(e)},e.registerOnRemoveHandler=function(e){st.config.registerOnRemoveHandlerHelper(e)}}(_o||(_o={}));var Ho,Do,Lo=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},No=e.V_1;!function(e){function n(e){if(void 0===e.url)throw new Error("url property of taskInfo object can't be undefined");return{url:e.url,size:{height:e.height?e.height:x.Small,width:e.width?e.width:x.Small},title:e.title,fallbackUrl:e.fallbackUrl}}function r(e){if(void 0===e.url||void 0===e.completionBotId)throw new Error("Both url ".concat(e.url," and completionBotId ").concat(e.completionBotId," are required for bot url dialog. At least one is undefined."));return{url:e.url,size:{height:e.height?e.height:x.Small,width:e.width?e.width:x.Small},title:e.title,fallbackUrl:e.fallbackUrl,completionBotId:e.completionBotId}}function o(e){return e.height=e.height?e.height:x.Small,e.width=e.width?e.width:x.Small,e}e.startTask=function(e,o){var i=a(No,t.Tasks_StartTask),s=o?function(e){var t,n;return o(null!==(t=e.err)&&void 0!==t?t:"",null!==(n=e.result)&&void 0!==n?n:"")}:void 0;return void 0===e.card&&void 0===e.url||e.card?(Ue(Ce,D.content,D.sidePanel,D.meetingStage),Qt(i,"tasks.startTask",[e],o)):void 0!==e.completionBotId?Ze(i,r(e),s):Ke(i,n(e),s),new fr},e.updateTask=function(e){(e=o(e)).width,e.height;var n=Lo(e,["width","height"]);if(Object.keys(n).length)throw new Error("resize requires a TaskInfo argument containing only width and height");Je(a(No,t.Tasks_UpdateTask),e)},e.submitTask=function(e,n){Xe(a(No,t.Tasks_SubmitTask),e,n)},e.getDefaultSizeIfNotProvided=o}(Ho||(Ho={})),function(e){!function(e){e.guest="Guest",e.attendee="Attendee",e.presenter="Presenter",e.organizer="Organizer"}(e.UserMeetingRole||(e.UserMeetingRole={})),function(e){e.added="Added",e.alreadyExists="AlreadyExists",e.conflict="Conflict",e.notFound="NotFound"}(e.ContainerState||(e.ContainerState={})),e.isSupported=function(){return!(!Ue(Ce,D.meetingStage,D.sidePanel)||!Ce.supports.interactive)}}(Do||(Do={}));var Uo=function(){function e(){}return e.prototype.getFluidTenantInfo=function(){return Vo(),new Promise((function(e){e(Kt("interactive.getFluidTenantInfo"))}))},e.prototype.getFluidToken=function(e){return Vo(),new Promise((function(t){t(Kt("interactive.getFluidToken",e))}))},e.prototype.getFluidContainerId=function(){return Vo(),new Promise((function(e){e(Kt("interactive.getFluidContainerId"))}))},e.prototype.setFluidContainerId=function(e){return Vo(),new Promise((function(t){t(Kt("interactive.setFluidContainerId",e))}))},e.prototype.getNtpTime=function(){return Vo(),new Promise((function(e){e(Kt("interactive.getNtpTime"))}))},e.prototype.registerClientId=function(e){return Vo(),new Promise((function(t){t(Kt("interactive.registerClientId",e))}))},e.prototype.getClientRoles=function(e){return Vo(),new Promise((function(t){t(Kt("interactive.getClientRoles",e))}))},e.prototype.getClientInfo=function(e){return Vo(),new Promise((function(t){t(Kt("interactive.getClientInfo",e))}))},e.create=function(){return Vo(),new e},e}();function Vo(){if(!Do.isSupported())throw new Error("LiveShareHost Not supported")}const xo=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const Bo=function(e){return"string"==typeof e&&xo.test(e)};var Wo=function(){return Wo=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Wo.apply(this,arguments)},zo=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};function Go(e){try{return e.cartItems=jo(e.cartItems),e}catch(e){throw new Error("Error deserializing cart")}}function jo(e){return e.map((function(e){if(e.imageURL){var t=new URL(e.imageURL);e.imageURL=t}return e.accessories&&(e.accessories=jo(e.accessories)),e}))}var qo=function(e){try{return e.map((function(e){var t=e.imageURL,n=e.accessories,r=zo(e,["imageURL","accessories"]),o=Wo({},r);return t&&(o.imageURL=t.href),n&&(o.accessories=qo(n)),o}))}catch(e){throw new Error("Error serializing cart items")}};function Jo(e){if(!Array.isArray(e)||0===e.length)throw new Error("cartItems must be a non-empty array");for(var t=0,n=e;t<n.length;t++){var r=n[t];Zo(r),Ko(r.accessories)}}function Ko(e){if(null!=e){if(!Array.isArray(e)||0===e.length)throw new Error("CartItem.accessories must be a non-empty array");for(var t=0,n=e;t<n.length;t++){var r=n[t];if(r.accessories)throw new Error("Item in CartItem.accessories cannot have accessories");Zo(r)}}}function Zo(e){if(!e.id)throw new Error("cartItem.id must not be empty");if(!e.name)throw new Error("cartItem.name must not be empty");$o(e.price),Qo(e.quantity)}function Xo(e){if(null!=e){if(!e)throw new Error("id must not be empty");if(!1===Bo(e))throw new Error("id must be a valid UUID")}}function $o(e){if("number"!=typeof e||e<0)throw new Error("price ".concat(e," must be a number not less than 0"));if(parseFloat(e.toFixed(3))!==e)throw new Error("price ".concat(e," must have at most 3 decimal places"))}function Qo(e){if("number"!=typeof e||e<=0||parseInt(e.toString())!==e)throw new Error("quantity ".concat(e," must be an integer greater than 0"))}function Yo(e){if(!Object.values(ei.CartStatus).includes(e))throw new Error("cartStatus ".concat(e," is not valid"))}var ei,ti,ni,ri,oi,ii=function(){return ii=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ii.apply(this,arguments)},ai=e.V_2;!function(e){function n(){return!(!Ue(Ce)||!Ce.supports.marketplace)}e.cartVersion={majorVersion:1,minorVersion:1},function(e){e.TACAdminUser="TACAdminUser",e.TeamsAdminUser="TeamsAdminUser",e.TeamsEndUser="TeamsEndUser"}(e.Intent||(e.Intent={})),function(e){e.Open="Open",e.Processing="Processing",e.Processed="Processed",e.Closed="Closed",e.Error="Error"}(e.CartStatus||(e.CartStatus={})),e.getCart=function(){if(Ue(Ce,D.content,D.task),!n())throw B;return Jt(a(ai,t.Marketplace_GetCart),"marketplace.getCart",e.cartVersion).then(Go)},e.addOrUpdateCartItems=function(r){if(Ue(Ce,D.content,D.task),!n())throw B;if(!r)throw new Error("addOrUpdateCartItemsParams must be provided");return Xo(null==r?void 0:r.cartId),Jo(null==r?void 0:r.cartItems),Jt(a(ai,t.Marketplace_AddOrUpdateCartItems),"marketplace.addOrUpdateCartItems",ii(ii({},r),{cartItems:qo(r.cartItems),cartVersion:e.cartVersion})).then(Go)},e.removeCartItems=function(r){if(Ue(Ce,D.content,D.task),!n())throw B;if(!r)throw new Error("removeCartItemsParams must be provided");if(Xo(null==r?void 0:r.cartId),!Array.isArray(null==r?void 0:r.cartItemIds)||0===(null==r?void 0:r.cartItemIds.length))throw new Error("cartItemIds must be a non-empty array");return Jt(a(ai,t.Marketplace_RemoveCardItems),"marketplace.removeCartItems",ii(ii({},r),{cartVersion:e.cartVersion})).then(Go)},e.updateCartStatus=function(r){if(Ue(Ce,D.content,D.task),!n())throw B;if(!r)throw new Error("updateCartStatusParams must be provided");return Xo(null==r?void 0:r.cartId),Yo(null==r?void 0:r.cartStatus),Jt(a(ai,t.Marketplace_UpdateCartStatus),"marketplace.updateCartStatus",ii(ii({},r),{cartVersion:e.cartVersion})).then(Go)},e.isSupported=n}(ei||(ei={})),function(e){function t(e,t){return{errorCode:e,message:t}}!function(e){e.Dropbox="DROPBOX",e.Box="BOX",e.Sharefile="SHAREFILE",e.GoogleDrive="GOOGLEDRIVE",e.Egnyte="EGNYTE",e.SharePoint="SharePoint"}(e.CloudStorageProvider||(e.CloudStorageProvider={})),function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WopiIntegration=1]="WopiIntegration",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(e.CloudStorageProviderType||(e.CloudStorageProviderType={})),function(e){e.ClassMaterials="classMaterials"}(e.SpecialDocumentLibraryType||(e.SpecialDocumentLibraryType={})),function(e){e.Readonly="readonly"}(e.DocumentLibraryAccessType||(e.DocumentLibraryAccessType={})),function(e){e.Downloaded="Downloaded",e.Downloading="Downloading",e.Failed="Failed"}(e.FileDownloadStatus||(e.FileDownloadStatus={})),function(e){e.Download="DOWNLOAD",e.Upload="UPLOAD",e.Delete="DELETE"}(e.CloudStorageProviderFileAction||(e.CloudStorageProviderFileAction={})),e.getCloudStorageFolders=function(e,t){if(Ue(Ce,D.content),!e||0===e.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!t)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");Yt("files.getCloudStorageFolders",[e],t)},e.addCloudStorageFolder=function(e,t){if(Ue(Ce,D.content),!e||0===e.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");Yt("files.addCloudStorageFolder",[e],t)},e.deleteCloudStorageFolder=function(e,t,n){if(Ue(Ce,D.content),!e)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!n)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");Yt("files.deleteCloudStorageFolder",[e,t],n)},e.getCloudStorageFolderContents=function(e,t,n){if(Ue(Ce,D.content),!e||!t)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!n)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in e&&!e.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");Yt("files.getCloudStorageFolderContents",[e,t],n)},e.openCloudStorageFile=function(e,t,n){if(Ue(Ce,D.content),!e||!t)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(e.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");Yt("files.openCloudStorageFile",[e,t,n])},e.getExternalProviders=function(e,t){if(void 0===e&&(e=!1),Ue(Ce,D.content),!t)throw new Error("[files.getExternalProviders] Callback cannot be null");Yt("files.getExternalProviders",[e],t)},e.copyMoveFiles=function(e,t,n,r,o,i){if(void 0===o&&(o=!1),Ue(Ce,D.content),!e||0===e.length)throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!t)throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!n)throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!r)throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!i)throw new Error("[files.copyMoveFiles] callback cannot be null");Yt("files.copyMoveFiles",[e,t,n,r,o],i)},e.getFileDownloads=function(e){if(Ue(Ce,D.content),!e)throw new Error("[files.getFileDownloads] Callback cannot be null");Yt("files.getFileDownloads",[],e)},e.openDownloadFolder=function(e,t){if(void 0===e&&(e=void 0),Ue(Ce,D.content),!t)throw new Error("[files.openDownloadFolder] Callback cannot be null");Yt("files.openDownloadFolder",[e],t)},e.addCloudStorageProvider=function(e){if(Ue(Ce,D.content),!e)throw t(k.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");Yt("files.addCloudStorageProvider",[],e)},e.removeCloudStorageProvider=function(e,n){if(Ue(Ce,D.content),!n)throw t(k.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!e||!e.content)throw t(k.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");Yt("files.removeCloudStorageProvider",[e],n)},e.addCloudStorageProviderFile=function(e,n){if(Ue(Ce,D.content),!n)throw t(k.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw t(k.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");Yt("files.addCloudStorageProviderFile",[e],n)},e.renameCloudStorageProviderFile=function(e,n){if(Ue(Ce,D.content),!n)throw t(k.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw t(k.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");Yt("files.renameCloudStorageProviderFile",[e],n)},e.deleteCloudStorageProviderFile=function(e,n){if(Ue(Ce,D.content),!n)throw t(k.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw t(k.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");Yt("files.deleteCloudStorageProviderFile",[e],n)},e.downloadCloudStorageProviderFile=function(e,n){if(Ue(Ce,D.content),!n)throw t(k.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw t(k.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");Yt("files.downloadCloudStorageProviderFile",[e],n)},e.uploadCloudStorageProviderFile=function(e,n){if(Ue(Ce,D.content),!n)throw t(k.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw t(k.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!e.content.destinationFolder)throw t(k.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");Yt("files.uploadCloudStorageProviderFile",[e],n)},e.registerCloudStorageProviderListChangeHandler=function(e){if(Ue(Ce),!e)throw new Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");It("files.cloudStorageProviderListChange",e)},e.registerCloudStorageProviderContentChangeHandler=function(e){if(Ue(Ce),!e)throw new Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");It("files.cloudStorageProviderContentChange",e)}}(ti||(ti={})),function(e){function t(){return!(!Ue(Ce)||!Ce.supports.meetingRoom)}e.getPairedMeetingRoomInfo=function(){return new Promise((function(e){if(Ue(Ce),!t())throw B;e(Kt("meetingRoom.getPairedMeetingRoomInfo"))}))},e.sendCommandToPairedMeetingRoom=function(e){return new Promise((function(n){if(!e||0==e.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(Ue(Ce),!t())throw B;n(Kt("meetingRoom.sendCommandToPairedMeetingRoom",e))}))},e.registerMeetingRoomCapabilitiesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");if(Ue(Ce),!t())throw B;It("meetingRoom.meetingRoomCapabilitiesUpdate",(function(t){Ue(Ce),e(t)}))},e.registerMeetingRoomStatesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");if(Ue(Ce),!t())throw B;It("meetingRoom.meetingRoomStatesUpdate",(function(t){Ue(Ce),e(t)}))},e.isSupported=t}(ni||(ni={})),function(e){function t(){return!(!Ue(Ce)||!Ce.supports.notifications)}e.showNotification=function(e){if(Ue(Ce,D.content),!t())throw B;Yt("notifications.showNotification",[e])},e.isSupported=t}(ri||(ri={})),function(e){function t(){return!(!Ue(Ce)||!Ce.supports.remoteCamera)}!function(e){e.Reset="Reset",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut",e.PanLeft="PanLeft",e.PanRight="PanRight",e.TiltUp="TiltUp",e.TiltDown="TiltDown"}(e.ControlCommand||(e.ControlCommand={})),function(e){e[e.CommandResetError=0]="CommandResetError",e[e.CommandZoomInError=1]="CommandZoomInError",e[e.CommandZoomOutError=2]="CommandZoomOutError",e[e.CommandPanLeftError=3]="CommandPanLeftError",e[e.CommandPanRightError=4]="CommandPanRightError",e[e.CommandTiltUpError=5]="CommandTiltUpError",e[e.CommandTiltDownError=6]="CommandTiltDownError",e[e.SendDataError=7]="SendDataError"}(e.ErrorReason||(e.ErrorReason={})),function(e){e[e.None=0]="None",e[e.ControlDenied=1]="ControlDenied",e[e.ControlNoResponse=2]="ControlNoResponse",e[e.ControlBusy=3]="ControlBusy",e[e.AckTimeout=4]="AckTimeout",e[e.ControlTerminated=5]="ControlTerminated",e[e.ControllerTerminated=6]="ControllerTerminated",e[e.DataChannelError=7]="DataChannelError",e[e.ControllerCancelled=8]="ControllerCancelled",e[e.ControlDisabled=9]="ControlDisabled",e[e.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(e.SessionTerminatedReason||(e.SessionTerminatedReason={})),e.getCapableParticipants=function(e){if(!e)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");if(Ue(Ce,D.sidePanel),!t())throw B;Yt("remoteCamera.getCapableParticipants",e)},e.requestControl=function(e,n){if(!e)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!n)throw new Error("[remoteCamera.requestControl] Callback cannot be null");if(Ue(Ce,D.sidePanel),!t())throw B;Yt("remoteCamera.requestControl",[e],n)},e.sendControlCommand=function(e,n){if(!e)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!n)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");if(Ue(Ce,D.sidePanel),!t())throw B;Yt("remoteCamera.sendControlCommand",[e],n)},e.terminateSession=function(e){if(!e)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");if(Ue(Ce,D.sidePanel),!t())throw B;Yt("remoteCamera.terminateSession",e)},e.registerOnCapableParticipantsChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");if(Ue(Ce,D.sidePanel),!t())throw B;It("remoteCamera.capableParticipantsChange",e)},e.registerOnErrorHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");if(Ue(Ce,D.sidePanel),!t())throw B;It("remoteCamera.handlerError",e)},e.registerOnDeviceStateChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");if(Ue(Ce,D.sidePanel),!t())throw B;It("remoteCamera.deviceStateChange",e)},e.registerOnSessionStatusChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");if(Ue(Ce,D.sidePanel),!t())throw B;It("remoteCamera.sessionStatusChange",e)},e.isSupported=t}(oi||(oi={}));var si,ci,ui=e.V_1;!function(e){function n(){return!(!Ue(Ce)||!Ce.supports.appEntity)}e.selectAppEntity=function(e,r,o,i){if(Ue(Ce,D.content),!n())throw B;if(!e||0==e.length)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!i)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");Qt(a(ui,t.AppEntity_SelectAppEntity),"appEntity.selectAppEntity",[e,r,o],i)},e.isSupported=n}(si||(si={})),function(e){function t(){return!(!Ue(Ce)||!Ce.supports.teams)}!function(e){e[e.Regular=0]="Regular",e[e.Private=1]="Private",e[e.Shared=2]="Shared"}(e.ChannelType||(e.ChannelType={})),e.getTeamChannels=function(e,n){if(Ue(Ce,D.content),!t())throw B;if(!e)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!n)throw new Error("[teams.getTeamChannels] Callback cannot be null");Yt("teams.getTeamChannels",[e],n)},e.refreshSiteUrl=function(e,n){if(Ue(Ce),!t())throw B;if(!e)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!n)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");Yt("teams.refreshSiteUrl",[e],n)},e.isSupported=t,function(e){function t(){return!(!Ue(Ce)||!Ce.supports.teams)&&!!Ce.supports.teams.fullTrust}!function(e){function t(){return!(!Ue(Ce)||!Ce.supports.teams)&&(!!Ce.supports.teams.fullTrust&&!!Ce.supports.teams.fullTrust.joinedTeams)}e.getUserJoinedTeams=function(e){return new Promise((function(n){if(Ue(Ce),!t())throw B;if((C.hostClientType===M.android||C.hostClientType===M.teamsRoomsAndroid||C.hostClientType===M.teamsPhones||C.hostClientType===M.teamsDisplays)&&!Ve("2.0.1")){var r={errorCode:k.OLD_PLATFORM};throw new Error(JSON.stringify(r))}n(zt("getUserJoinedTeams",e))}))},e.isSupported=t}(e.joinedTeams||(e.joinedTeams={})),e.getConfigSetting=function(e){return new Promise((function(n){if(Ue(Ce),!t())throw B;n(zt("getConfigSetting",e))}))},e.isSupported=t}(e.fullTrust||(e.fullTrust={}))}(ci||(ci={}));var li,di=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))},fi=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};!function(e){var t,n=le()?void 0:new Kr(Yt);function r(e,t){var n=this;return function(r){return di(n,void 0,void 0,(function(){var n,o;return fi(this,(function(i){switch(i.label){case 0:return n=r.videoFrame,t.reportStartFrameProcessing(n.codedWidth,n.codedHeight),[4,e(r)];case 1:return o=i.sent(),t.reportFrameProcessed(),[2,o]}}))}))}}function o(e){return e.videoFrameBuffer=e.videoFrameBuffer||e.data,delete e.data,e}function i(){return Ue(Ce),Wr.isSupported()}function a(e){Yt("video.videoFrameProcessed",[e])}function s(e,n){void 0===n&&(n=t.Warn),Yt("video.notifyError",[e,n])}!function(e){e.Fatal="fatal",e.Warn="warn"}(t=e.ErrorLevel||(e.ErrorLevel={})),e.registerForVideoFrame=function(e){var t,c,u=this;if(!i())throw B;if(!e.videoFrameHandler||!e.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(Ue(Ce,D.sidePanel)){if(It("video.setFrameProcessTimeLimit",(function(e){return null==n?void 0:n.setFrameProcessTimeLimit(e)}),!1),null===(t=Ce.supports.video)||void 0===t?void 0:t.mediaStream)It("video.startVideoExtensibilityVideoStream",(function(t){return di(u,void 0,void 0,(function(){var o,i,a;return fi(this,(function(c){switch(c.label){case 0:return o=t.streamId,i=t.metadataInTexture,a=n?r(e.videoFrameHandler,n):e.videoFrameHandler,i?[4,Mr(o,a,s,n)]:[3,2];case 1:return c.sent(),[3,4];case 2:return[4,Or(o,a,s,n)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}),!1),Yt("video.mediaStream.registerForVideoFrame",[e.config]);else{if(!(null===(c=Ce.supports.video)||void 0===c?void 0:c.sharedFrame))throw B;It("video.newVideoFrame",(function(t){if(t){null==n||n.reportStartFrameProcessing(t.width,t.height);var r=t.timestamp;e.videoBufferHandler(o(t),(function(){null==n||n.reportFrameProcessed(),a(r)}),s)}}),!1),Yt("video.registerForVideoFrame",[e.config])}null==n||n.startMonitorSlowFrameProcessing()}},e.notifySelectedVideoEffectChanged=function(e,t,n){if(Ue(Ce,D.sidePanel),!i())throw B;Yt("video.videoEffectChanged",[e,t,n])},e.registerForVideoEffect=function(e){if(Ue(Ce,D.sidePanel),!i())throw B;It("video.effectParameterChange",Br(e,n),!1),Yt("video.registerForVideoEffect")},e.updatePersonalizedEffects=function(e){if(Ue(Ce,D.sidePanel),!Wr.isSupported())throw B;Yt("video.personalizedEffectsChanged",[e])},e.isSupported=i,e.notifyFatalError=function(e){if(Ue(Ce),!Wr.isSupported())throw B;s(e,t.Fatal)}}(li||(li={}))})(),r})()));
//# sourceMappingURL=MicrosoftTeams.min.js.map