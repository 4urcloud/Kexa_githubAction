"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib=require("tslib"),coreClient=require("@azure/core-client"),coreRestPipeline=require("@azure/core-rest-pipeline");function _interopNamespace(a){var t;return a&&a.__esModule?a:(t=Object.create(null),a&&Object.keys(a).forEach(function(e){var r;"default"!==e&&(r=Object.getOwnPropertyDescriptor(a,e),Object.defineProperty(t,e,r.get?r:{enumerable:!0,get:function(){return a[e]}}))}),t.default=a,Object.freeze(t))}var coreClient__namespace=_interopNamespace(coreClient),coreRestPipeline__namespace=_interopNamespace(coreRestPipeline);const pageMap=new WeakMap;function getContinuationToken(e){return"object"!=typeof e||null===e||null==(e=pageMap.get(e))?void 0:e.continuationToken}function setContinuationToken(e,r){var a;"object"==typeof e&&null!==e&&r&&((a=null!=(a=pageMap.get(e))?a:{}).continuationToken=r,pageMap.set(e,a))}const ChangeResourceListResult={type:{name:"Composite",className:"ChangeResourceListResult",modelProperties:{nextLink:{serializedName:"nextLink",type:{name:"String"}},value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"ChangeResourceResult"}}}}}}},ChangeProperties={type:{name:"Composite",className:"ChangeProperties",modelProperties:{targetResourceId:{serializedName:"targetResourceId",readOnly:!0,type:{name:"String"}},targetResourceType:{serializedName:"targetResourceType",readOnly:!0,type:{name:"String"}},changeType:{serializedName:"changeType",readOnly:!0,type:{name:"Enum",allowedValues:["Update","Delete","Create"]}},changeAttributes:{serializedName:"changeAttributes",type:{name:"Composite",className:"ChangeAttributes"}},changes:{serializedName:"changes",type:{name:"Dictionary",value:{type:{name:"Composite",className:"ChangeBase"}}}}}}},ChangeAttributes={type:{name:"Composite",className:"ChangeAttributes",modelProperties:{correlationId:{serializedName:"correlationId",readOnly:!0,type:{name:"String"}},timestamp:{serializedName:"timestamp",readOnly:!0,type:{name:"String"}},changesCount:{serializedName:"changesCount",readOnly:!0,type:{name:"Number"}},previousResourceSnapshotId:{serializedName:"previousResourceSnapshotId",readOnly:!0,type:{name:"String"}},newResourceSnapshotId:{serializedName:"newResourceSnapshotId",readOnly:!0,type:{name:"String"}}}}},ChangeBase={type:{name:"Composite",className:"ChangeBase",modelProperties:{propertyChangeType:{serializedName:"propertyChangeType",readOnly:!0,type:{name:"Enum",allowedValues:["Update","Insert","Remove"]}},changeCategory:{serializedName:"changeCategory",readOnly:!0,type:{name:"Enum",allowedValues:["User","System"]}},previousValue:{serializedName:"previousValue",readOnly:!0,type:{name:"String"}},newValue:{serializedName:"newValue",readOnly:!0,type:{name:"String"}}}}},Resource={type:{name:"Composite",className:"Resource",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},name:{serializedName:"name",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",readOnly:!0,type:{name:"String"}}}}},ErrorResponse={type:{name:"Composite",className:"ErrorResponse",modelProperties:{error:{serializedName:"error",type:{name:"Composite",className:"ErrorDetail"}}}}},ErrorDetail={type:{name:"Composite",className:"ErrorDetail",modelProperties:{code:{serializedName:"code",readOnly:!0,type:{name:"String"}},message:{serializedName:"message",readOnly:!0,type:{name:"String"}},target:{serializedName:"target",readOnly:!0,type:{name:"String"}},details:{serializedName:"details",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ErrorDetail"}}}},additionalInfo:{serializedName:"additionalInfo",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ErrorAdditionalInfo"}}}}}}},ErrorAdditionalInfo={type:{name:"Composite",className:"ErrorAdditionalInfo",modelProperties:{type:{serializedName:"type",readOnly:!0,type:{name:"String"}},info:{serializedName:"info",readOnly:!0,type:{name:"Dictionary",value:{type:{name:"any"}}}}}}},ChangeResourceResult={type:{name:"Composite",className:"ChangeResourceResult",modelProperties:Object.assign(Object.assign({},Resource.type.modelProperties),{properties:{serializedName:"properties",type:{name:"Composite",className:"ChangeProperties"}}})}};var Mappers=Object.freeze({__proto__:null,ChangeResourceListResult:ChangeResourceListResult,ChangeProperties:ChangeProperties,ChangeAttributes:ChangeAttributes,ChangeBase:ChangeBase,Resource:Resource,ErrorResponse:ErrorResponse,ErrorDetail:ErrorDetail,ErrorAdditionalInfo:ErrorAdditionalInfo,ChangeResourceResult:ChangeResourceResult});const accept={parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},$host={parameterPath:"$host",mapper:{serializedName:"$host",required:!0,type:{name:"String"}},skipEncoding:!0},subscriptionId={parameterPath:"subscriptionId",mapper:{serializedName:"subscriptionId",required:!0,type:{name:"String"}}},resourceGroupName={parameterPath:"resourceGroupName",mapper:{serializedName:"resourceGroupName",required:!0,type:{name:"String"}}},resourceProviderNamespace={parameterPath:"resourceProviderNamespace",mapper:{serializedName:"resourceProviderNamespace",required:!0,type:{name:"String"}}},resourceType={parameterPath:"resourceType",mapper:{serializedName:"resourceType",required:!0,type:{name:"String"}}},resourceName={parameterPath:"resourceName",mapper:{serializedName:"resourceName",required:!0,type:{name:"String"}}},apiVersion={parameterPath:"apiVersion",mapper:{defaultValue:"2022-05-01",isConstant:!0,serializedName:"api-version",type:{name:"String"}}},top={parameterPath:["options","top"],mapper:{defaultValue:100,constraints:{InclusiveMaximum:100,InclusiveMinimum:1},serializedName:"$top",type:{name:"Number"}}},skipToken={parameterPath:["options","skipToken"],mapper:{serializedName:"$skipToken",type:{name:"String"}}},changeResourceId={parameterPath:"changeResourceId",mapper:{serializedName:"changeResourceId",required:!0,type:{name:"String"}}},nextLink={parameterPath:"nextLink",mapper:{serializedName:"nextLink",required:!0,type:{name:"String"}},skipEncoding:!0};class ChangesImpl{constructor(e){this.client=e}list(r,a,t,i,s){const e=this.listPagingAll(r,a,t,i,s);return{next(){return e.next()},[Symbol.asyncIterator](){return this},byPage:e=>{if(null!=e&&e.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listPagingPage(r,a,t,i,s,e)}}}listPagingPage(i,s,n,o,p,l){return tslib.__asyncGenerator(this,arguments,function*(){let e,r=null==l?void 0:l.continuationToken;var a;for(r||(setContinuationToken(a=(e=yield tslib.__await(this._list(i,s,n,o,p))).value||[],r=e.nextLink),yield yield tslib.__await(a));r;){e=yield tslib.__await(this._listNext(i,s,n,o,r,p)),r=e.nextLink;var t=e.value||[];setContinuationToken(t,r),yield yield tslib.__await(t)}})}listPagingAll(s,n,o,p,l){return tslib.__asyncGenerator(this,arguments,function*(){var r,e;try{for(var a,t=tslib.__asyncValues(this.listPagingPage(s,n,o,p,l));!(a=yield tslib.__await(t.next())).done;){var i=a.value;yield tslib.__await(yield*tslib.__asyncDelegator(tslib.__asyncValues(i)))}}catch(e){r={error:e}}finally{try{a&&!a.done&&(e=t.return)&&(yield tslib.__await(e.call(t)))}finally{if(r)throw r.error}}})}_list(e,r,a,t,i){return this.client.sendOperationRequest({resourceGroupName:e,resourceProviderNamespace:r,resourceType:a,resourceName:t,options:i},listOperationSpec)}get(e,r,a,t,i,s){return this.client.sendOperationRequest({resourceGroupName:e,resourceProviderNamespace:r,resourceType:a,resourceName:t,changeResourceId:i,options:s},getOperationSpec)}_listNext(e,r,a,t,i,s){return this.client.sendOperationRequest({resourceGroupName:e,resourceProviderNamespace:r,resourceType:a,resourceName:t,nextLink:i,options:s},listNextOperationSpec)}}const serializer=coreClient__namespace.createSerializer(Mappers,!1),listOperationSpec={path:"/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/{resourceProviderNamespace}/{resourceType}/{resourceName}/providers/Microsoft.Resources/changes",httpMethod:"GET",responses:{200:{bodyMapper:ChangeResourceListResult},default:{bodyMapper:ErrorResponse}},queryParameters:[apiVersion,top,skipToken],urlParameters:[$host,subscriptionId,resourceGroupName,resourceProviderNamespace,resourceType,resourceName],headerParameters:[accept],serializer:serializer},getOperationSpec={path:"/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/{resourceProviderNamespace}/{resourceType}/{resourceName}/providers/Microsoft.Resources/changes/{changeResourceId}",httpMethod:"GET",responses:{200:{bodyMapper:ChangeResourceResult},default:{bodyMapper:ErrorResponse}},queryParameters:[apiVersion],urlParameters:[$host,subscriptionId,resourceGroupName,resourceProviderNamespace,resourceType,resourceName,changeResourceId],headerParameters:[accept],serializer:serializer},listNextOperationSpec={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:ChangeResourceListResult},default:{bodyMapper:ErrorResponse}},queryParameters:[apiVersion,top,skipToken],urlParameters:[$host,subscriptionId,resourceGroupName,resourceProviderNamespace,resourceType,resourceName,nextLink],headerParameters:[accept],serializer:serializer};class ChangesClient extends coreClient__namespace.ServiceClient{constructor(e,r,a){if(void 0===e)throw new Error("'credentials' cannot be null");if(void 0===r)throw new Error("'subscriptionId' cannot be null");var t,i="azsdk-js-arm-changes/1.1.0",i=(a=a||{}).userAgentOptions&&a.userAgentOptions.userAgentPrefix?a.userAgentOptions.userAgentPrefix+" "+i:i,i=Object.assign(Object.assign(Object.assign({},{requestContentType:"application/json; charset=utf-8",credential:e}),a),{userAgentOptions:{userAgentPrefix:i},endpoint:null!=(i=null!=(i=a.endpoint)?i:a.baseUri)?i:"https://management.azure.com"});super(i);let s=!1;null!=a&&a.pipeline&&0<a.pipeline.getOrderedPolicies().length&&(t=a.pipeline.getOrderedPolicies(),s=t.some(e=>e.name===coreRestPipeline__namespace.bearerTokenAuthenticationPolicyName)),a&&a.pipeline&&0!=a.pipeline.getOrderedPolicies().length&&s||(this.pipeline.removePolicy({name:coreRestPipeline__namespace.bearerTokenAuthenticationPolicyName}),this.pipeline.addPolicy(coreRestPipeline__namespace.bearerTokenAuthenticationPolicy({credential:e,scopes:null!=(t=i.credentialScopes)?t:i.endpoint+"/.default",challengeCallbacks:{authorizeRequestOnChallenge:coreClient__namespace.authorizeRequestOnClaimChallenge}}))),this.subscriptionId=r,this.$host=a.$host||"https://management.azure.com",this.apiVersion=a.apiVersion||"2022-05-01",this.changes=new ChangesImpl(this),this.addCustomApiVersionPolicy(a.apiVersion)}addCustomApiVersionPolicy(i){i&&this.pipeline.addPolicy({name:"CustomApiVersionPolicy",sendRequest(a,t){return tslib.__awaiter(this,void 0,void 0,function*(){var e,r=a.url.split("?");return 1<r.length&&(e=r[1].split("&").map(e=>-1<e.indexOf("api-version")?"api-version="+i:e),a.url=r[0]+"?"+e.join("&")),t(a)})}})}}exports.ChangesClient=ChangesClient,exports.getContinuationToken=getContinuationToken;